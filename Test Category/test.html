<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="preload" href="/wiki/_next/static/media/5e749c662e1c4510-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/wiki/_next/static/media/7f3351e323b56175-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/wiki/_next/static/media/659df64606270f52-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/wiki/_next/static/media/ebfe4f524cbef140-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/wiki/_next/static/media/df3bfb9215b6902e-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/wiki/_next/static/media/6d5c75d8b54988bb-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/wiki/_next/static/css/0028c8c793affaf4.css" as="style"/><link rel="stylesheet" href="/wiki/_next/static/css/0028c8c793affaf4.css" data-n-g=""/><link rel="preload" href="/wiki/_next/static/css/b35dc63be6ca6d86.css" as="style"/><link rel="stylesheet" href="/wiki/_next/static/css/b35dc63be6ca6d86.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/wiki/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/wiki/_next/static/chunks/webpack-23a357e212078f0c.js" defer=""></script><script src="/wiki/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/wiki/_next/static/chunks/main-e8508cb07ad73fb0.js" defer=""></script><script src="/wiki/_next/static/chunks/pages/_app-81a5fbaf954d5916.js" defer=""></script><script src="/wiki/_next/static/chunks/7f0c75c1-544495866c712888.js" defer=""></script><script src="/wiki/_next/static/chunks/104-e6b66cb4460978d7.js" defer=""></script><script src="/wiki/_next/static/chunks/pages/%5BcategorySlug%5D/%5BpostSlug%5D-bf0b4047b5158220.js" defer=""></script><script src="/wiki/_next/static/w4U2GQiaVQ1l-eevK1JWn/_buildManifest.js" defer=""></script><script src="/wiki/_next/static/w4U2GQiaVQ1l-eevK1JWn/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="__className_405d37"><header class="fixed px-5 min-h-[50px] block md:hidden bg-white dark:bg-gray-900 w-full z-10 items-center"><a href="/wiki"><svg width="60" height="50" viewBox="0 0 220 59" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M20.608 18.728H31.616L19.232 31.272L32.896 45H21.632L11.488 34.44V45H1.76V0.967999H11.488V27.88L20.608 18.728ZM32.6205 45V18.728H42.3485V45H32.6205ZM37.6125 13.32C36.0765 13.32 34.7752 12.7867 33.7085 11.72C32.6418 10.632 32.1085 9.34133 32.1085 7.848C32.1085 6.35467 32.6418 5.064 33.7085 3.976C34.7965 2.86666 36.0978 2.312 37.6125 2.312C38.6152 2.312 39.5325 2.568 40.3645 3.08C41.1965 3.57066 41.8685 4.232 42.3805 5.064C42.8925 5.896 43.1485 6.824 43.1485 7.848C43.1485 9.34133 42.6045 10.632 41.5165 11.72C40.4285 12.7867 39.1272 13.32 37.6125 13.32ZM66.0745 29.768L59.9625 45H51.0345L42.3305 18.728H52.6665L56.8585 34.6L62.9065 19.24H69.3065L75.2585 34.6L79.4825 18.728H89.8185L81.1465 45H72.2505L66.0745 29.768ZM89.7205 45V18.728H99.4485V45H89.7205ZM94.7125 13.32C93.1765 13.32 91.8752 12.7867 90.8085 11.72C89.7418 10.632 89.2085 9.34133 89.2085 7.848C89.2085 6.35467 89.7418 5.064 90.8085 3.976C91.8965 2.86666 93.1978 2.312 94.7125 2.312C95.7152 2.312 96.6325 2.568 97.4645 3.08C98.2965 3.57066 98.9685 4.232 99.4805 5.064C99.9925 5.896 100.249 6.824 100.249 7.848C100.249 9.34133 99.7045 10.632 98.6165 11.72C97.5285 12.7867 96.2272 13.32 94.7125 13.32ZM109.478 45.768C107.9 45.768 106.534 45.2027 105.382 44.072C104.252 42.92 103.686 41.5547 103.686 39.976C103.686 38.3547 104.252 36.9787 105.382 35.848C106.534 34.696 107.9 34.12 109.478 34.12C111.1 34.12 112.476 34.696 113.606 35.848C114.737 36.9787 115.302 38.3547 115.302 39.976C115.302 41.5547 114.737 42.92 113.606 44.072C112.476 45.2027 111.1 45.768 109.478 45.768ZM139.412 29.768L133.3 45H124.372L115.668 18.728H126.004L130.196 34.6L136.244 19.24H142.644L148.596 34.6L152.82 18.728H163.156L154.484 45H145.588L139.412 29.768ZM163.058 45V18.728H172.786V45H163.058ZM168.05 13.32C166.514 13.32 165.213 12.7867 164.146 11.72C163.079 10.632 162.546 9.34133 162.546 7.848C162.546 6.35467 163.079 5.064 164.146 3.976C165.234 2.86666 166.535 2.312 168.05 2.312C169.053 2.312 169.97 2.568 170.802 3.08C171.634 3.57066 172.306 4.232 172.818 5.064C173.33 5.896 173.586 6.824 173.586 7.848C173.586 9.34133 173.042 10.632 171.954 11.72C170.866 12.7867 169.565 13.32 168.05 13.32ZM194.208 18.728H205.216L192.832 31.272L206.496 45H195.232L185.088 34.44V45H175.36V0.967999H185.088V27.88L194.208 18.728ZM206.22 45V18.728H215.948V45H206.22ZM211.212 13.32C209.676 13.32 208.375 12.7867 207.308 11.72C206.242 10.632 205.708 9.34133 205.708 7.848C205.708 6.35467 206.242 5.064 207.308 3.976C208.396 2.86666 209.698 2.312 211.212 2.312C212.215 2.312 213.132 2.568 213.964 3.08C214.796 3.57066 215.468 4.232 215.98 5.064C216.492 5.896 216.748 6.824 216.748 7.848C216.748 9.34133 216.204 10.632 215.116 11.72C214.028 12.7867 212.727 13.32 211.212 13.32Z" fill="currentColor"></path></svg></a></header><div class="relative max-w-screen-xl px-4 pt-14 pb-10 mx-auto md:flex md:py-10 md:flex-row"><div class="gap-5 p-4 hidden md:flex w-72 md:shrink-0 sticky top-10 h-full md:flex-col text-black dark:text-gray-100"><a href="/wiki"><svg width="100" height="50" viewBox="0 0 220 59" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M20.608 18.728H31.616L19.232 31.272L32.896 45H21.632L11.488 34.44V45H1.76V0.967999H11.488V27.88L20.608 18.728ZM32.6205 45V18.728H42.3485V45H32.6205ZM37.6125 13.32C36.0765 13.32 34.7752 12.7867 33.7085 11.72C32.6418 10.632 32.1085 9.34133 32.1085 7.848C32.1085 6.35467 32.6418 5.064 33.7085 3.976C34.7965 2.86666 36.0978 2.312 37.6125 2.312C38.6152 2.312 39.5325 2.568 40.3645 3.08C41.1965 3.57066 41.8685 4.232 42.3805 5.064C42.8925 5.896 43.1485 6.824 43.1485 7.848C43.1485 9.34133 42.6045 10.632 41.5165 11.72C40.4285 12.7867 39.1272 13.32 37.6125 13.32ZM66.0745 29.768L59.9625 45H51.0345L42.3305 18.728H52.6665L56.8585 34.6L62.9065 19.24H69.3065L75.2585 34.6L79.4825 18.728H89.8185L81.1465 45H72.2505L66.0745 29.768ZM89.7205 45V18.728H99.4485V45H89.7205ZM94.7125 13.32C93.1765 13.32 91.8752 12.7867 90.8085 11.72C89.7418 10.632 89.2085 9.34133 89.2085 7.848C89.2085 6.35467 89.7418 5.064 90.8085 3.976C91.8965 2.86666 93.1978 2.312 94.7125 2.312C95.7152 2.312 96.6325 2.568 97.4645 3.08C98.2965 3.57066 98.9685 4.232 99.4805 5.064C99.9925 5.896 100.249 6.824 100.249 7.848C100.249 9.34133 99.7045 10.632 98.6165 11.72C97.5285 12.7867 96.2272 13.32 94.7125 13.32ZM109.478 45.768C107.9 45.768 106.534 45.2027 105.382 44.072C104.252 42.92 103.686 41.5547 103.686 39.976C103.686 38.3547 104.252 36.9787 105.382 35.848C106.534 34.696 107.9 34.12 109.478 34.12C111.1 34.12 112.476 34.696 113.606 35.848C114.737 36.9787 115.302 38.3547 115.302 39.976C115.302 41.5547 114.737 42.92 113.606 44.072C112.476 45.2027 111.1 45.768 109.478 45.768ZM139.412 29.768L133.3 45H124.372L115.668 18.728H126.004L130.196 34.6L136.244 19.24H142.644L148.596 34.6L152.82 18.728H163.156L154.484 45H145.588L139.412 29.768ZM163.058 45V18.728H172.786V45H163.058ZM168.05 13.32C166.514 13.32 165.213 12.7867 164.146 11.72C163.079 10.632 162.546 9.34133 162.546 7.848C162.546 6.35467 163.079 5.064 164.146 3.976C165.234 2.86666 166.535 2.312 168.05 2.312C169.053 2.312 169.97 2.568 170.802 3.08C171.634 3.57066 172.306 4.232 172.818 5.064C173.33 5.896 173.586 6.824 173.586 7.848C173.586 9.34133 173.042 10.632 171.954 11.72C170.866 12.7867 169.565 13.32 168.05 13.32ZM194.208 18.728H205.216L192.832 31.272L206.496 45H195.232L185.088 34.44V45H175.36V0.967999H185.088V27.88L194.208 18.728ZM206.22 45V18.728H215.948V45H206.22ZM211.212 13.32C209.676 13.32 208.375 12.7867 207.308 11.72C206.242 10.632 205.708 9.34133 205.708 7.848C205.708 6.35467 206.242 5.064 207.308 3.976C208.396 2.86666 209.698 2.312 211.212 2.312C212.215 2.312 213.132 2.568 213.964 3.08C214.796 3.57066 215.468 4.232 215.98 5.064C216.492 5.896 216.748 6.824 216.748 7.848C216.748 9.34133 216.204 10.632 215.116 11.72C214.028 12.7867 212.727 13.32 211.212 13.32Z" fill="currentColor"></path></svg></a><div class="flex flex-col w-full gap-3"><button class="text-sm font-light border px-3 py-2 rounded-md flex justify-between text-gray-400 border-gray-200 hover:border-gray-300 dark:text-gray-600 dark:border-gray-700 dark:hover:border-gray-600"><span>Search...</span><span>⌘K</span></button><nav class="h-full flex overflow-y-scroll overscroll-contain flex-col px-2"><ul class="h-[calc(100vh-200px)] visible flex flex-col"><a class="text-gray-800 dark:text-gray-300 font-bold" href="/wiki/Test%20Category"><li class="transition-all py-2 hover:px-2 relative break-all overflow-hidden h-10"><div class="text-md">Test Category</div></li></a></ul></nav></div></div><main class="flex flex-col gap-4 md:gap-10 p-2 md:p-6 w-full min-w-0"><nav class="flex text-xs md:text-sm items-center gap-1.5"><li class="list-none flex items-center text-gray-400 hover:text-gray-500 dark:text-gray-700 dark:hover:text-gray-600"><a href="/wiki">Home</a><span><svg stroke="currentColor" fill="none" stroke-width="0" viewBox="0 0 15 15" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M6.18194 4.18185C6.35767 4.00611 6.6426 4.00611 6.81833 4.18185L9.81833 7.18185C9.90272 7.26624 9.95013 7.3807 9.95013 7.50005C9.95013 7.6194 9.90272 7.73386 9.81833 7.81825L6.81833 10.8182C6.6426 10.994 6.35767 10.994 6.18194 10.8182C6.0062 10.6425 6.0062 10.3576 6.18194 10.1819L8.86374 7.50005L6.18194 4.81825C6.0062 4.64251 6.0062 4.35759 6.18194 4.18185Z" fill="currentColor"></path></svg></span></li><li class="list-none flex items-center text-gray-400 hover:text-gray-500 dark:text-gray-700 dark:hover:text-gray-600"><a href="/wiki/Test%20Category">Test Category</a><span><svg stroke="currentColor" fill="none" stroke-width="0" viewBox="0 0 15 15" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M6.18194 4.18185C6.35767 4.00611 6.6426 4.00611 6.81833 4.18185L9.81833 7.18185C9.90272 7.26624 9.95013 7.3807 9.95013 7.50005C9.95013 7.6194 9.90272 7.73386 9.81833 7.81825L6.81833 10.8182C6.6426 10.994 6.35767 10.994 6.18194 10.8182C6.0062 10.6425 6.0062 10.3576 6.18194 10.1819L8.86374 7.50005L6.18194 4.81825C6.0062 4.64251 6.0062 4.35759 6.18194 4.18185Z" fill="currentColor"></path></svg></span></li><li class="list-none flex items-center text-gray-400 hover:text-gray-500 dark:text-gray-700 dark:hover:text-gray-600"><span class="text-gray-800 dark:text-gray-300">Test Post</span></li></nav><div class="flex flex-col gap-4 md:gap-5"><div class="flex flex-col gap-10"><h1 class="font-bold text-xl md:text-2xl lg:text-3xl">Test Post</h1></div><div class="flex gap-8 items-end justify-between"><a target="_blank" href="https://github.com/jeonbyeongmin"><div class="flex flex-row gap-3"><img alt="avatar" loading="lazy" width="40" height="40" decoding="async" data-nimg="1" class="rounded-full w-8 h-8 md:w-10 md:h-10" style="color:transparent" src="https://avatars.githubusercontent.com/u/28756358?v=4"/><div class="flex flex-col justify-center"><span class="text-xs md:text-sm font-bold">Byeongmin Jeon</span><span class="text-[10px] md:text-xs text-gray-400 dark:text-gray-600">JavaScript/React developer</span></div></div></a><div class="flex flex-col gap-2"><span class="text-[10px] md:text-xs text-gray-400 dark:text-gray-600">Updated on Wed Jan 01 2020</span></div></div></div><article class="w-full select-none text-lg leading-relaxed text-gray-600 post_markdown__0DbFM"><h2 id="서론"><a aria-hidden="true" tabindex="-1" href="#서론"><span class="icon icon-link"></span></a>서론</h2>
<p>시간표와 관련된 프로젝트에서 <code>&lt;table /&gt;</code>요소를 마우스로 드래그해서 선택해야 하는 기능이 필요했습니다. 기능 구현을 위해 리서치를 진행했습니다. 유사 라이브러리에서 <code>MouseEvent</code>및 <code>TouchEvent</code>를 활용하는 방식으로 구현되어 있었습니다. 저 또한 이 기능을 구현하기 위해서 마우스 이벤트 및 터치 이벤트를 활용하기로 결정했습니다.</p>
<p>하지만 개발자는 어떻게 사용자가 드래그를 하고 있다고 판단할 수 있죠? 생각해보니 마우스 이벤트와 터치 이벤트에 대해 깊게 공부해본 적이 없다는 것을 깨닫게 되었습니다. 그토록 사용해온 <code>click</code>이벤트가 <code>MouseEvent</code>임에도 불구하고 말입니다! 기능 구현하기 위해 마우스 및 터치 이벤트에 대해 알아볼 필요가 있었습니다.</p>
<p>이번 포스트에서는 <strong>&#x27;드래그로 선택 가능한 테이블&#x27;</strong> 개발 과정 및 리팩토링 과정을 소개합니다. 또 겸사겸사 정리했던 마우스 이벤트 및 터치 이벤트에 대해서 소개합니다.</p>
<blockquote>
<p><strong>드래그로 선택 가능한 테이블</strong> 이라는 명칭이 너무 길기 때문에 지금부터는 <strong>드래그 테이블</strong> 이라고 명명하겠습니다.</p>
</blockquote>
<br/>
<hr/>
<h2 id="구현-기능에-대한-이해"><a aria-hidden="true" tabindex="-1" href="#구현-기능에-대한-이해"><span class="icon icon-link"></span></a>구현 기능에 대한 이해</h2>
<h3 id="요구-사항-작성하기"><a aria-hidden="true" tabindex="-1" href="#요구-사항-작성하기"><span class="icon icon-link"></span></a>요구 사항 작성하기</h3>
<p>어떻게 구현을 할 지 결정하기 전, 무엇을 구현해야 하는 지를 확실히 해둘 필요가 있었습니다. 드래그 테이블을 구현하기 위해 기능 요구 사항을 정리하였습니다.</p>
<h4 id="기능-요구-사항"><a aria-hidden="true" tabindex="-1" href="#기능-요구-사항"><span class="icon icon-link"></span></a>기능 요구 사항</h4>
<ol>
<li>테이블의 선택 가능 범위가 N*M 크기라면 <code>value</code>는 N*M 크기를 가져야 합니다.</li>
<li><code>value</code>의 타입은 <code>boolean[][]</code>이어야 합니다.</li>
<li><code>value</code>는 외부에서 값을 받을 수 있어야 합니다.</li>
<li>테이블 내 임의의 셀의 값 <code>x</code>에 대해, <strong>click</strong> 이 발생하면 해당 셀의 값은 <code>!x</code>가 되어야 합니다.<!-- -->
<ul>
<li><em>false</em> 일 때 <strong>click</strong> 하면 <em>true</em> 가 되어야 합니다.</li>
<li><em>true</em> 일 때 <strong>click</strong> 하면 <em>false</em> 가 되어야 합니다.</li>
</ul>
</li>
<li><strong>drag</strong> 할 때 처음 클릭한 셀의 값을 <code>x</code>라고 한다면, 출발지 좌표와 목적지 좌표 사이에 존재하는 모든 셀의 값은 <code>!x</code>가 되어야 합니다.<!-- -->
<ul>
<li>출발지 좌표와 목적지 좌표 사이의 임의 값을 <code>x</code>라고 한다면, 모든 <code>x</code>에 대해서 다음의 식을 만족해야 합니다.</li>
<li><code>(startRow &lt;= x.row &lt;= endRow) &amp;&amp; (startColumn &lt;= x.column &lt;= endColumn)</code></li>
</ul>
</li>
<li>모든 디바이스 환경에서 동일하게 동작해야 합니다. 즉, 환경에 상관 없이 PC와 모바일 모두 <strong>click</strong> 및 <strong>drag</strong> 이벤트를 지원해야 합니다.<!-- -->
<ul>
<li>테이블을 드래그하는 동안 스크롤이 발생하면 안됩니다.</li>
</ul>
</li>
</ol>
<p>단순히 생각해봐도 드래그에는 <code>click</code>이벤트만으로 충분치 않습니다. 확실한 한 가지는 드래그는 마우스(터치)를 이용해서 한다는 것입니다. 즉, <code>MouseEvent</code>와 <code>TouchEvent</code>를 알아볼 필요가 있었습니다.</p>
<p><code>PointerEvent</code>라는 것도 있지만, 모바일 디바이스 터치의 기본 동작인 스크롤을 비활성화 하기 위해서 <code>TouchEvent</code>를 따로 처리할 필요가 있었습니다. 그래서 드래그 테이블을 구현할 때에는 <code>MouseEvent</code>와 <code>TouchEvent</code>를 사용하였습니다.</p>
<blockquote>
<h4 id="pointerevent"><a aria-hidden="true" tabindex="-1" href="#pointerevent"><span class="icon icon-link"></span></a>PointerEvent</h4>
<p>옛날에는 <code>MouseEvent</code>만 존재했습니다. 모바일 기기들이 나오면서 마우스로는 할 수 없던 것들(e.g. 멀티 터치)이 가능해졌습니다. 새로운 환경에 맞는 새로운 인터페이스가 필요했고 그것이 <code>TouchEvent</code>입니다. 하지만 <code>TouchEvent</code>로 충분하지 않은 상황(e.g. 스타일러스 펜)이 생겼습니다. 게다가 <code>MouseEvent</code>와 <code>TouchEvent</code>를 모두 사용하는 경우가 많아졌습니다. 이러한 한계들을 해결하기 위해서 <code>PointerEvent</code>가 탄생했습니다.</p>
</blockquote>
<br/>
<h3 id="mouseevent-알아보기"><a aria-hidden="true" tabindex="-1" href="#mouseevent-알아보기"><span class="icon icon-link"></span></a>MouseEvent 알아보기</h3>
<p><code>click</code>이벤트 이외에 어떤 이벤트들이 <code>MouseEvent</code>에 속할까요? 비슷한 이벤트끼리 묶어서 정리 해보았습니다.</p>
<h4 id="mousedown--mouseup--click"><a aria-hidden="true" tabindex="-1" href="#mousedown--mouseup--click"><span class="icon icon-link"></span></a>mousedown / mouseup / click</h4>
<p>세 가지 이벤트는 <code>MouseEvent</code>중에서도 클릭과 관련이 깊습니다. <code>mousedown</code>은 마우스 버튼이 눌리는 순간에 발생합니다. <code>mouseup</code>은 마우스 버튼이 올라오는 순간에 발생합니다. <code>click</code>은 <code>mouseup</code>이후에 발생합니다. 즉, 사용자가 마우스를 클릭하면 이벤트는 다음과 같은 순서로 발생합니다.</p>
<pre class="pre_pre__iJ9A8 group"><div class="pre_label__h_sWI">text</div><div class="pre_code__KcFrc"><code>mousedown -&gt; mouseup -&gt; click
</code></div></pre>
<blockquote>
<h4 id="mouseup-vs-click"><a aria-hidden="true" tabindex="-1" href="#mouseup-vs-click"><span class="icon icon-link"></span></a>mouseup vs click</h4>
<p><code>mouseup</code>이 있는데 <code>click</code>이 왜 필요하죠? 실제로 이 둘은 비슷한 일을 하는 것처럼 보입니다. 하지만 <code>click</code>에는 몇 가지 조건이 필요합니다. 대표적으로 <code>mousedown</code>과 <code>mouseup</code>이 같은 요소에서 발생해야 <code>click</code>이벤트가 발생한다는 것이 있습니다. 이것이 <code>click</code>이 <code>mouseup</code>이후에 발생해야 하는 이유입니다. 이러한 조건 덕분에 <code>click</code>이벤트를 사용하면 사용자 실수 방지와 같은 효과를 얻을 수 있습니다.</p>
</blockquote>
<h4 id="mousemove"><a aria-hidden="true" tabindex="-1" href="#mousemove"><span class="icon icon-link"></span></a>mousemove</h4>
<p>마우스가 요소 위에서 움직일 때 발생합니다. <code>mousemove</code>도 드래그를 구현하기에 훌륭하지만 <code>mousemove</code>는 마우스를 움직일 때마다 발생하기 때문에, 최적화 작업이 특히 까다로울 것입니다. 우선 넘어가겠습니다.</p>
<h4 id="mouseenter--mouseover"><a aria-hidden="true" tabindex="-1" href="#mouseenter--mouseover"><span class="icon icon-link"></span></a>mouseenter / mouseover</h4>
<p>두 이벤트 모두 마우스 커서가 특정 요소 안으로 진입할 때 발생하는 이벤트입니다. 이 대목에서 두 이벤트는 테이블을 드래그하기에 적절할 것으로 보입니다. 다만, <code>mouseenter</code>는 버블링이 일어나지 않습니다. 따라서 자식 요소로 커서를 옮겨도 이벤트가 다시 발생하지 않습니다. 그에 비해 <code>mouseover</code>는 버블링이 일어나기 때문에 자식 요소에 커서를 옮기면 이벤트가 다시 발생합니다. 버블링을 활용하면 구현이 단순해지기 때문에 저는 <code>mouseover</code>를 사용하기로 결정합니다.</p>
<h4 id="mouseleave--mouseout"><a aria-hidden="true" tabindex="-1" href="#mouseleave--mouseout"><span class="icon icon-link"></span></a>mouseleave / mouseout</h4>
<p>두 이벤트 모두 마우스 커서가 요소를 떠날 때 발생합니다. 그 외에는 <code>mouseenter</code>와 <code>mouseover</code>의 관계와 같습니다. <code>mouseleave</code>는 버블링이 일어나지 않는 반면, <code>mouseout</code>은 버블링이 일어납니다.</p>
<blockquote>
<h4 id="mouseenter-와-mouseleave"><a aria-hidden="true" tabindex="-1" href="#mouseenter-와-mouseleave"><span class="icon icon-link"></span></a>mouseenter 와 mouseleave</h4>
<p>두 이벤트는 요소들를 감싸는 컨테이너의 hover 를 처리할 때 사용한 적이 있었습니다. <code>mouseover</code>및 <code>mouseout</code>과 다르게 버블링이 일어나지 않는 것이 hover 를 처리하기에 적합했습니다.</p>
</blockquote>
<br/>
<h3 id="touchevent-알아보기"><a aria-hidden="true" tabindex="-1" href="#touchevent-알아보기"><span class="icon icon-link"></span></a>TouchEvent 알아보기</h3>
<p>작성한 요구 사항에는 사용자 환경에 상관없이 항상 드래그 기능을 제공해야 한다는 것이 포함되어 있습니다. 이를 위해 사용한 <code>TouchEvent</code>에 대해 소개합니다.</p>
<h4 id="touchstart--touchmove--touchend"><a aria-hidden="true" tabindex="-1" href="#touchstart--touchmove--touchend"><span class="icon icon-link"></span></a>touchstart / touchmove / touchend</h4>
<p><code>touchstart</code>는 사용자의 손가락이 화면에 닿았을 때 발생합니다. <code>touchmove</code>는 사용자의 손가락이 화면에서 움직이는 동안 계속 발생합니다. <code>touchend</code>는 사용자의 손가락을 화면에서 뗄 때 발생합니다. <code>touchstart</code>와 <code>touchend</code>는 <code>mousedown</code>과<code>mouseup</code>처럼 사용될 수 있지만, <code>touchmove</code>는 <code>mouseover</code>보단 <code>mousemove</code>와 유사합니다. 안타깝게도 <code>mouseover</code>처럼 손가락이 특정 요소에 진입할 때 발생하는 이벤트는 없습니다.</p>
<p>다행히 다음과 같은 코드로 사용자 손가락이 위치한 곳의 요소를 가져올 수는 있습니다.</p>
<div data-rehype-pretty-code-fragment=""><pre data-language="js" data-theme="dark" class="pre_pre__iJ9A8 group"><div data-language="js" class="pre_label__h_sWI">js</div><div class="pre_button-wrapper__UqcNw group-hover:opacity-100"><button class="transition-all rounded-md p-2 text-gray-400 hover:bg-gray-100 active:bg-gray-200 text-gray-500 dark:hover:bg-gray-600 dark:active:bg-gray-700"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><div class="pre_code__KcFrc"><code data-language="js" data-theme="dark"><span class="line"><span style="color:#F97583">const</span><span style="color:#E1E4E8"> { </span><span style="color:#79B8FF">clientX</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">clientY</span><span style="color:#E1E4E8"> } </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> e.touches[</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">];</span></span>
<span class="line"><span style="color:#E1E4E8">target </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> document.</span><span style="color:#B392F0">elementFromPoint</span><span style="color:#E1E4E8">(clientX, clientY);</span></span></code></div></pre><pre data-language="js" data-theme="light" class="pre_pre__iJ9A8 group"><div data-language="js" class="pre_label__h_sWI">js</div><div class="pre_button-wrapper__UqcNw group-hover:opacity-100"><button class="transition-all rounded-md p-2 text-gray-400 hover:bg-gray-100 active:bg-gray-200 text-gray-500 dark:hover:bg-gray-600 dark:active:bg-gray-700"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><div class="pre_code__KcFrc"><code data-language="js" data-theme="light"><span class="line"><span style="color:#D73A49">const</span><span style="color:#24292E"> { </span><span style="color:#005CC5">clientX</span><span style="color:#24292E">, </span><span style="color:#005CC5">clientY</span><span style="color:#24292E"> } </span><span style="color:#D73A49">=</span><span style="color:#24292E"> e.touches[</span><span style="color:#005CC5">0</span><span style="color:#24292E">];</span></span>
<span class="line"><span style="color:#24292E">target </span><span style="color:#D73A49">=</span><span style="color:#24292E"> document.</span><span style="color:#6F42C1">elementFromPoint</span><span style="color:#24292E">(clientX, clientY);</span></span></code></div></pre></div>
<p><code>touches</code>는 사용자 손가락과 닿아있는 <a href="https://developer.mozilla.org/en-US/docs/Web/API/Touch">Touch</a> 리스트를 반환합니다. <code>Touch</code>는 프로퍼티로 <code>clientX</code>와 <code>clientY</code>를 제공하니 <code>elementFromPoint(clientX, clientY)</code>로 손가락 위치의 요소를 가져올 수 있습니다. 정확도도 준수했습니다.</p>
<h4 id="스크롤-제어"><a aria-hidden="true" tabindex="-1" href="#스크롤-제어"><span class="icon icon-link"></span></a>스크롤 제어</h4>
<p><code>touchmove</code>로 좌표값을 가져온다고 했지만, 만약 해당 요소가 스크롤이 가능하다면 어떻게 될까요? 당연히 스크롤과 <code>touchmove</code>가 같이 실행되어 원하는대로 동작하지 않습니다. 테이블을 드래그하는 동안은 스크롤이 발생하면 안됩니다.</p>
<div data-rehype-pretty-code-fragment=""><pre data-language="ts" data-theme="dark" class="pre_pre__iJ9A8 group"><div data-language="ts" class="pre_label__h_sWI">ts</div><div class="pre_button-wrapper__UqcNw group-hover:opacity-100"><button class="transition-all rounded-md p-2 text-gray-400 hover:bg-gray-100 active:bg-gray-200 text-gray-500 dark:hover:bg-gray-600 dark:active:bg-gray-700"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><div class="pre_code__KcFrc"><code data-language="ts" data-theme="dark"><span class="line"><span style="color:#E1E4E8">element.</span><span style="color:#B392F0">addEventListener</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#x27;touchstart&#x27;</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">e</span><span style="color:#E1E4E8"> </span><span style="color:#F97583">=&gt;</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">  e.</span><span style="color:#B392F0">preventDefault</span><span style="color:#E1E4E8">();</span></span>
<span class="line"><span style="color:#E1E4E8">});</span></span></code></div></pre><pre data-language="ts" data-theme="light" class="pre_pre__iJ9A8 group"><div data-language="ts" class="pre_label__h_sWI">ts</div><div class="pre_button-wrapper__UqcNw group-hover:opacity-100"><button class="transition-all rounded-md p-2 text-gray-400 hover:bg-gray-100 active:bg-gray-200 text-gray-500 dark:hover:bg-gray-600 dark:active:bg-gray-700"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><div class="pre_code__KcFrc"><code data-language="ts" data-theme="light"><span class="line"><span style="color:#24292E">element.</span><span style="color:#6F42C1">addEventListener</span><span style="color:#24292E">(</span><span style="color:#032F62">&#x27;touchstart&#x27;</span><span style="color:#24292E">, </span><span style="color:#E36209">e</span><span style="color:#24292E"> </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#24292E">  e.</span><span style="color:#6F42C1">preventDefault</span><span style="color:#24292E">();</span></span>
<span class="line"><span style="color:#24292E">});</span></span></code></div></pre></div>
<p><code>touchstart</code>의 기본 동작으로 스크롤이 포함합니다. 따라서 <code>e.preventDefault()</code>로 기본 동작을 취소해주어야 스크롤이 발생하지 않습니다.</p>
<h4 id="이벤트-발생-순서"><a aria-hidden="true" tabindex="-1" href="#이벤트-발생-순서"><span class="icon icon-link"></span></a>이벤트 발생 순서</h4>
<p>터치 이벤트를 사용할 때에는 몇 가지 주의해야 할 것이 있습니다. 모바일 디바이스에서 <code>click</code>이벤트가 발생했던 것을 기억해보세요. 호환성 문제로 모바일 디바이스에서도 <code>MouseEvent</code>들이 발생합니다. 브라우저마다 차이는 있지만 일반적으로 다음과 같은 순서로 발생합니다.</p>
<pre class="pre_pre__iJ9A8 group"><div class="pre_label__h_sWI">text</div><div class="pre_code__KcFrc"><code>Touch for click
touchstart -&gt; touchend -&gt; mousemove -&gt; mousedown -&gt; mouseup -&gt; click

Touch for move
touchstart -&gt; touchmove -&gt; touchend
</code></div></pre>
<p>핵심은 클릭을 위해 터치를 하면 터치 이벤트와 마우스 이벤트가 전부 일어날 수 있다는 것 입니다. <strong>즉, <code>TouchEvent</code>와 <code>MouseEvent</code>를 동시에 사용할 때에는 특정 함수가 두 번 실행되지 않도록 특별히 처리해줘야 합니다.</strong></p>
<h4 id="browser-compatibility"><a aria-hidden="true" tabindex="-1" href="#browser-compatibility"><span class="icon icon-link"></span></a>Browser compatibility</h4>
<p><code>TouchEvent</code>인터페이스 및 터치 이벤트들은 <em>PC Safari, Opera</em> 에서 지원되지 않습니다. 터치 이벤트 자체는 PC에서 발생할 일이 없으니 상관없지만 이벤트를 구분하기 위해서 인터페이스를 직접 사용할 때는 종종 있습니다. 가령 아래의 코드를 작성하면 <em>Safari, Opera</em> 에서 에러가 발생합니다. 따라서 두 번째 코드처럼 우회하여 터치 이벤트를 판별해야 합니다.</p>
<div data-rehype-pretty-code-fragment=""><pre data-language="ts" data-theme="dark" class="pre_pre__iJ9A8 group"><div data-language="ts" class="pre_label__h_sWI">ts</div><div class="pre_button-wrapper__UqcNw group-hover:opacity-100"><button class="transition-all rounded-md p-2 text-gray-400 hover:bg-gray-100 active:bg-gray-200 text-gray-500 dark:hover:bg-gray-600 dark:active:bg-gray-700"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><div class="pre_code__KcFrc"><code data-language="ts" data-theme="dark"><span class="line"><span style="color:#F97583">if</span><span style="color:#E1E4E8"> (event </span><span style="color:#F97583">instanceof</span><span style="color:#E1E4E8"> </span><span style="color:#B392F0">TouchEvent</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#E1E4E8">  console.</span><span style="color:#B392F0">log</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#x27;이 이벤트는 터치 이벤트입니다.&#x27;</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></div></pre><pre data-language="ts" data-theme="light" class="pre_pre__iJ9A8 group"><div data-language="ts" class="pre_label__h_sWI">ts</div><div class="pre_button-wrapper__UqcNw group-hover:opacity-100"><button class="transition-all rounded-md p-2 text-gray-400 hover:bg-gray-100 active:bg-gray-200 text-gray-500 dark:hover:bg-gray-600 dark:active:bg-gray-700"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><div class="pre_code__KcFrc"><code data-language="ts" data-theme="light"><span class="line"><span style="color:#D73A49">if</span><span style="color:#24292E"> (event </span><span style="color:#D73A49">instanceof</span><span style="color:#24292E"> </span><span style="color:#6F42C1">TouchEvent</span><span style="color:#24292E">) {</span></span>
<span class="line"><span style="color:#24292E">  console.</span><span style="color:#6F42C1">log</span><span style="color:#24292E">(</span><span style="color:#032F62">&#x27;이 이벤트는 터치 이벤트입니다.&#x27;</span><span style="color:#24292E">);</span></span>
<span class="line"><span style="color:#24292E">}</span></span></code></div></pre></div>
<div data-rehype-pretty-code-fragment=""><pre data-language="ts" data-theme="dark" class="pre_pre__iJ9A8 group"><div data-language="ts" class="pre_label__h_sWI">ts</div><div class="pre_button-wrapper__UqcNw group-hover:opacity-100"><button class="transition-all rounded-md p-2 text-gray-400 hover:bg-gray-100 active:bg-gray-200 text-gray-500 dark:hover:bg-gray-600 dark:active:bg-gray-700"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><div class="pre_code__KcFrc"><code data-language="ts" data-theme="dark"><span class="line"><span style="color:#F97583">if</span><span style="color:#E1E4E8"> (</span><span style="color:#9ECBFF">&#x27;ontouchstart&#x27;</span><span style="color:#E1E4E8"> </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> window </span><span style="color:#F97583">&amp;&amp;</span><span style="color:#E1E4E8"> event.type.</span><span style="color:#B392F0">startsWith</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#x27;touch&#x27;</span><span style="color:#E1E4E8">)) {</span></span>
<span class="line"><span style="color:#E1E4E8">  console.</span><span style="color:#B392F0">log</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#x27;이 이벤트는 터치 이벤트입니다.&#x27;</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></div></pre><pre data-language="ts" data-theme="light" class="pre_pre__iJ9A8 group"><div data-language="ts" class="pre_label__h_sWI">ts</div><div class="pre_button-wrapper__UqcNw group-hover:opacity-100"><button class="transition-all rounded-md p-2 text-gray-400 hover:bg-gray-100 active:bg-gray-200 text-gray-500 dark:hover:bg-gray-600 dark:active:bg-gray-700"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><div class="pre_code__KcFrc"><code data-language="ts" data-theme="light"><span class="line"><span style="color:#D73A49">if</span><span style="color:#24292E"> (</span><span style="color:#032F62">&#x27;ontouchstart&#x27;</span><span style="color:#24292E"> </span><span style="color:#D73A49">in</span><span style="color:#24292E"> window </span><span style="color:#D73A49">&amp;&amp;</span><span style="color:#24292E"> event.type.</span><span style="color:#6F42C1">startsWith</span><span style="color:#24292E">(</span><span style="color:#032F62">&#x27;touch&#x27;</span><span style="color:#24292E">)) {</span></span>
<span class="line"><span style="color:#24292E">  console.</span><span style="color:#6F42C1">log</span><span style="color:#24292E">(</span><span style="color:#032F62">&#x27;이 이벤트는 터치 이벤트입니다.&#x27;</span><span style="color:#24292E">);</span></span>
<span class="line"><span style="color:#24292E">}</span></span></code></div></pre></div>
<p>브라우저 전역객체에 <code>ontouchstart</code>가 존재하는지와 이벤트 타입이 <code>touch</code>시작하는지 확인하여 이벤트가 터치 이벤트인지 판별할 수 있습니다.</p>
<div data-rehype-pretty-code-fragment=""><pre data-language="ts" data-theme="dark" class="pre_pre__iJ9A8 group"><div data-language="ts" class="pre_label__h_sWI">ts</div><div class="pre_button-wrapper__UqcNw group-hover:opacity-100"><button class="transition-all rounded-md p-2 text-gray-400 hover:bg-gray-100 active:bg-gray-200 text-gray-500 dark:hover:bg-gray-600 dark:active:bg-gray-700"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><div class="pre_code__KcFrc"><code data-language="ts" data-theme="dark"><span class="line"><span style="color:#F97583">if</span><span style="color:#E1E4E8"> (</span><span style="color:#B392F0">isMobile</span><span style="color:#E1E4E8">()) {</span></span>
<span class="line"><span style="color:#E1E4E8">  console.</span><span style="color:#B392F0">log</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#x27;이 부분은 모바일에서만 실행됩니다&#x27;</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></div></pre><pre data-language="ts" data-theme="light" class="pre_pre__iJ9A8 group"><div data-language="ts" class="pre_label__h_sWI">ts</div><div class="pre_button-wrapper__UqcNw group-hover:opacity-100"><button class="transition-all rounded-md p-2 text-gray-400 hover:bg-gray-100 active:bg-gray-200 text-gray-500 dark:hover:bg-gray-600 dark:active:bg-gray-700"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><div class="pre_code__KcFrc"><code data-language="ts" data-theme="light"><span class="line"><span style="color:#D73A49">if</span><span style="color:#24292E"> (</span><span style="color:#6F42C1">isMobile</span><span style="color:#24292E">()) {</span></span>
<span class="line"><span style="color:#24292E">  console.</span><span style="color:#6F42C1">log</span><span style="color:#24292E">(</span><span style="color:#032F62">&#x27;이 부분은 모바일에서만 실행됩니다&#x27;</span><span style="color:#24292E">);</span></span>
<span class="line"><span style="color:#24292E">}</span></span></code></div></pre></div>
<p>물론 이렇게 이벤트가 아니라 <code>userAgent</code>를 가져와 모바일 디바이스인지를 판별하는 방법을 사용해도 되겠습니다.</p>
<p><img src="https://velog.velcdn.com/images/jeonbyeongmin/post/b76e556f-e947-43b5-9d8b-a6cefe1800c9/image.png" alt="touchstart"/></p>
<br/>
<h3 id="정리하기"><a aria-hidden="true" tabindex="-1" href="#정리하기"><span class="icon icon-link"></span></a>정리하기</h3>
<p>이제 제가 작성한 코드를 이해하기에 충분합니다. 본격적으로 코드를 설명하기 전에 위 정보를 종합하여 간략히 정리해보겠습니다.</p>
<h4 id="구현에-사용할-이벤트"><a aria-hidden="true" tabindex="-1" href="#구현에-사용할-이벤트"><span class="icon icon-link"></span></a>구현에 사용할 이벤트</h4>
<ul>
<li>mousedown / touchstart : 드래그 시작할 때</li>
<li>mouseover / touchmove : 드래그 중일 때</li>
<li>mouseup / touchend : 드래그 끝날 때</li>
</ul>
<h4 id="구현-시-프로그램-요구-사항"><a aria-hidden="true" tabindex="-1" href="#구현-시-프로그램-요구-사항"><span class="icon icon-link"></span></a>구현 시 프로그램 요구 사항</h4>
<ul>
<li><code>&lt;table /&gt;</code>에 event listener 를 붙여놓고 <code>&lt;td /&gt;</code>에서 발생한 이벤트 버블링을 활용하여 코드를 작성할 것</li>
<li><code>TouchEvent</code>인터페이스를 직접 사용하지 않을 것</li>
<li>테이블을 드래그할 때에는 스크롤을 비활성화할 것</li>
<li>터치 이벤트 직후 발생하는 마우스 이벤트가 같은 작업을 반복하지 않도록 만들 것</li>
</ul>
<br/>
<hr/>
<h2 id="구현"><a aria-hidden="true" tabindex="-1" href="#구현"><span class="icon icon-link"></span></a>구현</h2>
<p>지금부터는 기능 요구사항을 바탕으로 구현한 드래그 테이블 컴포넌트를 설명드리겠습니다. 핵심 로직과 관련이 없는 부분은 생략합니다.</p>
<h3 id="드래그-테이블-컴포넌트-구현하기"><a aria-hidden="true" tabindex="-1" href="#드래그-테이블-컴포넌트-구현하기"><span class="icon icon-link"></span></a>드래그 테이블 컴포넌트 구현하기</h3>
<div data-rehype-pretty-code-fragment=""><pre data-language="tsx" data-theme="dark" class="pre_pre__iJ9A8 group"><div data-language="tsx" class="pre_label__h_sWI">tsx</div><div class="pre_button-wrapper__UqcNw group-hover:opacity-100"><button class="transition-all rounded-md p-2 text-gray-400 hover:bg-gray-100 active:bg-gray-200 text-gray-500 dark:hover:bg-gray-600 dark:active:bg-gray-700"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><div class="pre_code__KcFrc"><code data-language="tsx" data-theme="dark"><span class="line"><span style="color:#F97583">function</span><span style="color:#E1E4E8"> </span><span style="color:#B392F0">DraggableTable</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">initialValue</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#E1E4E8">  </span><span style="color:#F97583">const</span><span style="color:#E1E4E8"> </span><span style="color:#79B8FF">startIndex</span><span style="color:#E1E4E8"> </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> </span><span style="color:#B392F0">useRef</span><span style="color:#E1E4E8">&lt;</span><span style="color:#79B8FF">string</span><span style="color:#E1E4E8">&gt;(</span><span style="color:#9ECBFF">&#x27;&#x27;</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#E1E4E8">  </span><span style="color:#F97583">const</span><span style="color:#E1E4E8"> </span><span style="color:#79B8FF">currentIndex</span><span style="color:#E1E4E8"> </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> </span><span style="color:#B392F0">useRef</span><span style="color:#E1E4E8">&lt;</span><span style="color:#79B8FF">string</span><span style="color:#E1E4E8">&gt;(</span><span style="color:#9ECBFF">&#x27;&#x27;</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#E1E4E8">  </span><span style="color:#F97583">const</span><span style="color:#E1E4E8"> </span><span style="color:#79B8FF">startTable</span><span style="color:#E1E4E8"> </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> </span><span style="color:#B392F0">useRef</span><span style="color:#E1E4E8">&lt;</span><span style="color:#79B8FF">boolean</span><span style="color:#E1E4E8">[][]&gt;([]);</span></span>
<span class="line"><span style="color:#E1E4E8">  </span><span style="color:#F97583">const</span><span style="color:#E1E4E8"> </span><span style="color:#79B8FF">mode</span><span style="color:#E1E4E8"> </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> </span><span style="color:#B392F0">useRef</span><span style="color:#E1E4E8">&lt;</span><span style="color:#79B8FF">boolean</span><span style="color:#E1E4E8">&gt;(</span><span style="color:#79B8FF">false</span><span style="color:#E1E4E8">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">  </span><span style="color:#F97583">const</span><span style="color:#E1E4E8"> [</span><span style="color:#79B8FF">value</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">setValue</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> </span><span style="color:#B392F0">useState</span><span style="color:#E1E4E8">&lt;</span><span style="color:#79B8FF">boolean</span><span style="color:#E1E4E8">[][]&gt;(initialValue);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">  </span><span style="color:#F97583">return</span><span style="color:#E1E4E8"> (</span></span>
<span class="line"><span style="color:#E1E4E8">    &lt;</span><span style="color:#79B8FF">Table</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">      &lt;</span><span style="color:#79B8FF">THead</span><span style="color:#E1E4E8">&gt;{</span><span style="color:#6A737D">/* ...생략 */</span><span style="color:#E1E4E8">}&lt;/</span><span style="color:#79B8FF">THead</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">      &lt;</span><span style="color:#79B8FF">TBody</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">        {value.</span><span style="color:#B392F0">map</span><span style="color:#E1E4E8">((</span><span style="color:#FFAB70">row</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">rowIndex</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">=&gt;</span><span style="color:#E1E4E8"> (</span></span>
<span class="line"><span style="color:#E1E4E8">          &lt;</span><span style="color:#79B8FF">TR</span><span style="color:#E1E4E8"> </span><span style="color:#B392F0">key</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">{rowIndex}&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">            &lt;</span><span style="color:#79B8FF">TH</span><span style="color:#E1E4E8">&gt;{time}&lt;/</span><span style="color:#79B8FF">TH</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">            {row.</span><span style="color:#B392F0">map</span><span style="color:#E1E4E8">(() </span><span style="color:#F97583">=&gt;</span><span style="color:#E1E4E8"> (</span></span>
<span class="line"><span style="color:#E1E4E8">              &lt;</span><span style="color:#79B8FF">TD</span><span style="color:#E1E4E8">&gt;&lt;/</span><span style="color:#79B8FF">TD</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">            ))}</span></span>
<span class="line"><span style="color:#E1E4E8">          &lt;/</span><span style="color:#79B8FF">TR</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">        ))}</span></span>
<span class="line"><span style="color:#E1E4E8">      &lt;/</span><span style="color:#79B8FF">TBody</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">    &lt;/</span><span style="color:#79B8FF">Table</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">  );</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></div></pre><pre data-language="tsx" data-theme="light" class="pre_pre__iJ9A8 group"><div data-language="tsx" class="pre_label__h_sWI">tsx</div><div class="pre_button-wrapper__UqcNw group-hover:opacity-100"><button class="transition-all rounded-md p-2 text-gray-400 hover:bg-gray-100 active:bg-gray-200 text-gray-500 dark:hover:bg-gray-600 dark:active:bg-gray-700"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><div class="pre_code__KcFrc"><code data-language="tsx" data-theme="light"><span class="line"><span style="color:#D73A49">function</span><span style="color:#24292E"> </span><span style="color:#6F42C1">DraggableTable</span><span style="color:#24292E">(</span><span style="color:#E36209">initialValue</span><span style="color:#24292E">) {</span></span>
<span class="line"><span style="color:#24292E">  </span><span style="color:#D73A49">const</span><span style="color:#24292E"> </span><span style="color:#005CC5">startIndex</span><span style="color:#24292E"> </span><span style="color:#D73A49">=</span><span style="color:#24292E"> </span><span style="color:#6F42C1">useRef</span><span style="color:#24292E">&lt;</span><span style="color:#005CC5">string</span><span style="color:#24292E">&gt;(</span><span style="color:#032F62">&#x27;&#x27;</span><span style="color:#24292E">);</span></span>
<span class="line"><span style="color:#24292E">  </span><span style="color:#D73A49">const</span><span style="color:#24292E"> </span><span style="color:#005CC5">currentIndex</span><span style="color:#24292E"> </span><span style="color:#D73A49">=</span><span style="color:#24292E"> </span><span style="color:#6F42C1">useRef</span><span style="color:#24292E">&lt;</span><span style="color:#005CC5">string</span><span style="color:#24292E">&gt;(</span><span style="color:#032F62">&#x27;&#x27;</span><span style="color:#24292E">);</span></span>
<span class="line"><span style="color:#24292E">  </span><span style="color:#D73A49">const</span><span style="color:#24292E"> </span><span style="color:#005CC5">startTable</span><span style="color:#24292E"> </span><span style="color:#D73A49">=</span><span style="color:#24292E"> </span><span style="color:#6F42C1">useRef</span><span style="color:#24292E">&lt;</span><span style="color:#005CC5">boolean</span><span style="color:#24292E">[][]&gt;([]);</span></span>
<span class="line"><span style="color:#24292E">  </span><span style="color:#D73A49">const</span><span style="color:#24292E"> </span><span style="color:#005CC5">mode</span><span style="color:#24292E"> </span><span style="color:#D73A49">=</span><span style="color:#24292E"> </span><span style="color:#6F42C1">useRef</span><span style="color:#24292E">&lt;</span><span style="color:#005CC5">boolean</span><span style="color:#24292E">&gt;(</span><span style="color:#005CC5">false</span><span style="color:#24292E">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E">  </span><span style="color:#D73A49">const</span><span style="color:#24292E"> [</span><span style="color:#005CC5">value</span><span style="color:#24292E">, </span><span style="color:#005CC5">setValue</span><span style="color:#24292E">] </span><span style="color:#D73A49">=</span><span style="color:#24292E"> </span><span style="color:#6F42C1">useState</span><span style="color:#24292E">&lt;</span><span style="color:#005CC5">boolean</span><span style="color:#24292E">[][]&gt;(initialValue);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E">  </span><span style="color:#D73A49">return</span><span style="color:#24292E"> (</span></span>
<span class="line"><span style="color:#24292E">    &lt;</span><span style="color:#005CC5">Table</span><span style="color:#24292E">&gt;</span></span>
<span class="line"><span style="color:#24292E">      &lt;</span><span style="color:#005CC5">THead</span><span style="color:#24292E">&gt;{</span><span style="color:#6A737D">/* ...생략 */</span><span style="color:#24292E">}&lt;/</span><span style="color:#005CC5">THead</span><span style="color:#24292E">&gt;</span></span>
<span class="line"><span style="color:#24292E">      &lt;</span><span style="color:#005CC5">TBody</span><span style="color:#24292E">&gt;</span></span>
<span class="line"><span style="color:#24292E">        {value.</span><span style="color:#6F42C1">map</span><span style="color:#24292E">((</span><span style="color:#E36209">row</span><span style="color:#24292E">, </span><span style="color:#E36209">rowIndex</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> (</span></span>
<span class="line"><span style="color:#24292E">          &lt;</span><span style="color:#005CC5">TR</span><span style="color:#24292E"> </span><span style="color:#6F42C1">key</span><span style="color:#D73A49">=</span><span style="color:#24292E">{rowIndex}&gt;</span></span>
<span class="line"><span style="color:#24292E">            &lt;</span><span style="color:#005CC5">TH</span><span style="color:#24292E">&gt;{time}&lt;/</span><span style="color:#005CC5">TH</span><span style="color:#24292E">&gt;</span></span>
<span class="line"><span style="color:#24292E">            {row.</span><span style="color:#6F42C1">map</span><span style="color:#24292E">(() </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> (</span></span>
<span class="line"><span style="color:#24292E">              &lt;</span><span style="color:#005CC5">TD</span><span style="color:#24292E">&gt;&lt;/</span><span style="color:#005CC5">TD</span><span style="color:#24292E">&gt;</span></span>
<span class="line"><span style="color:#24292E">            ))}</span></span>
<span class="line"><span style="color:#24292E">          &lt;/</span><span style="color:#005CC5">TR</span><span style="color:#24292E">&gt;</span></span>
<span class="line"><span style="color:#24292E">        ))}</span></span>
<span class="line"><span style="color:#24292E">      &lt;/</span><span style="color:#005CC5">TBody</span><span style="color:#24292E">&gt;</span></span>
<span class="line"><span style="color:#24292E">    &lt;/</span><span style="color:#005CC5">Table</span><span style="color:#24292E">&gt;</span></span>
<span class="line"><span style="color:#24292E">  );</span></span>
<span class="line"><span style="color:#24292E">}</span></span></code></div></pre></div>
<p>드래그 테이블의 일부입니다. <code>value</code>를 상태로 가지고 <code>value</code>를 기반으로 테이블을 생성합니다. <code>&lt;Table /&gt;</code>에 이벤트 처리기를 붙이고 핸들러 함수를 넣어주었습니다. 각 핸들러 함수에 필요한 정보를 담아두기 위해서 네 가지 <code>ref</code>를 선언해두었습니다. 각각은 다음과 같은 역할을 수행합니다.</p>
<h4 id="startindex"><a aria-hidden="true" tabindex="-1" href="#startindex"><span class="icon icon-link"></span></a>startIndex</h4>
<p>드래그가 시작될 때, 드래그 시작 지점을 <code>startIndex</code>에 기록합니다. 이 값은 다양한 역할을 수행할 수 있습니다. 드래그의 시작 지점이므로 드래그의 기준점이 될 수 있습니다. 또 만약 <code>startIndex</code>가 <code>null</code>이면 현재 드래그를 하고 있지 않다는 것을 의미합니다.</p>
<h4 id="currentindex"><a aria-hidden="true" tabindex="-1" href="#currentindex"><span class="icon icon-link"></span></a>currentIndex</h4>
<p>드래그를 하고 있을 때, 즉 <code>handleDragMove</code>가 실행될 때 이전 인덱스와 현재 인덱스를 구별하기 위한 역할을 수행합니다.</p>
<h4 id="starttable"><a aria-hidden="true" tabindex="-1" href="#starttable"><span class="icon icon-link"></span></a>startTable</h4>
<p>드래그를 되돌릴 때, 드래그를 시작했을 때의 테이블 정보를 제공하는 역할을 수행합니다</p>
<h4 id="mode"><a aria-hidden="true" tabindex="-1" href="#mode"><span class="icon icon-link"></span></a>mode</h4>
<p>드래그가 시작될 때 처음 클릭한 셀이 <em>false</em> 라면 <em>true</em> 를 저장하고 <em>true</em> 면 <em>false</em> 를 저장하여 현재 드래그의 모드를 기록합니다.</p>
<br/>
<h3 id="핸들러-함수-구현하기"><a aria-hidden="true" tabindex="-1" href="#핸들러-함수-구현하기"><span class="icon icon-link"></span></a>핸들러 함수 구현하기</h3>
<h4 id="handledragstart"><a aria-hidden="true" tabindex="-1" href="#handledragstart"><span class="icon icon-link"></span></a>handleDragStart</h4>
<div data-rehype-pretty-code-fragment=""><pre data-language="tsx" data-theme="dark" class="pre_pre__iJ9A8 group"><div data-language="tsx" class="pre_label__h_sWI">tsx</div><div class="pre_button-wrapper__UqcNw group-hover:opacity-100"><button class="transition-all rounded-md p-2 text-gray-400 hover:bg-gray-100 active:bg-gray-200 text-gray-500 dark:hover:bg-gray-600 dark:active:bg-gray-700"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><div class="pre_code__KcFrc"><code data-language="tsx" data-theme="dark"><span class="line"><span style="color:#F97583">const</span><span style="color:#E1E4E8"> </span><span style="color:#B392F0">handleDragStart</span><span style="color:#E1E4E8"> </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> (</span><span style="color:#FFAB70">e</span><span style="color:#F97583">:</span><span style="color:#E1E4E8"> </span><span style="color:#B392F0">Event</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">=&gt;</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">  </span><span style="color:#F97583">const</span><span style="color:#E1E4E8"> </span><span style="color:#79B8FF">index</span><span style="color:#E1E4E8"> </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> </span><span style="color:#B392F0">getTableCellIndex</span><span style="color:#E1E4E8">(e);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">  </span><span style="color:#F97583">if</span><span style="color:#E1E4E8"> (index </span><span style="color:#F97583">===</span><span style="color:#E1E4E8"> </span><span style="color:#79B8FF">null</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#E1E4E8">    </span><span style="color:#F97583">return</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">  </span><span style="color:#F97583">if</span><span style="color:#E1E4E8"> (</span><span style="color:#B392F0">isMouseEvent</span><span style="color:#E1E4E8">(e) </span><span style="color:#F97583">&amp;&amp;</span><span style="color:#E1E4E8"> e.buttons </span><span style="color:#F97583">!==</span><span style="color:#E1E4E8"> </span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#E1E4E8">    </span><span style="color:#F97583">return</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">  </span><span style="color:#F97583">if</span><span style="color:#E1E4E8"> (</span><span style="color:#B392F0">isTouchEvent</span><span style="color:#E1E4E8">(e) </span><span style="color:#F97583">&amp;&amp;</span><span style="color:#E1E4E8"> e.cancelable) {</span></span>
<span class="line"><span style="color:#E1E4E8">    e.</span><span style="color:#B392F0">preventDefault</span><span style="color:#E1E4E8">();</span></span>
<span class="line"><span style="color:#E1E4E8">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">  </span><span style="color:#F97583">const</span><span style="color:#E1E4E8"> { </span><span style="color:#79B8FF">rowIndex</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">colIndex</span><span style="color:#E1E4E8"> } </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> index;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">  startTable.current </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [</span><span style="color:#F97583">...</span><span style="color:#E1E4E8">value];</span></span>
<span class="line"><span style="color:#E1E4E8">  startIndex.current </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> </span><span style="color:#B392F0">convertIndexToString</span><span style="color:#E1E4E8">(rowIndex, colIndex);</span></span>
<span class="line"><span style="color:#E1E4E8">  mode.current </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> </span><span style="color:#F97583">!</span><span style="color:#E1E4E8">value[rowIndex][colIndex];</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">  </span><span style="color:#F97583">const</span><span style="color:#E1E4E8"> </span><span style="color:#79B8FF">newValue</span><span style="color:#E1E4E8"> </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [</span><span style="color:#F97583">...</span><span style="color:#E1E4E8">value];</span></span>
<span class="line"><span style="color:#E1E4E8">  newValue[rowIndex][colIndex] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> mode.current;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">  </span><span style="color:#B392F0">setValue</span><span style="color:#E1E4E8">(newValue);</span></span>
<span class="line"><span style="color:#E1E4E8">};</span></span></code></div></pre><pre data-language="tsx" data-theme="light" class="pre_pre__iJ9A8 group"><div data-language="tsx" class="pre_label__h_sWI">tsx</div><div class="pre_button-wrapper__UqcNw group-hover:opacity-100"><button class="transition-all rounded-md p-2 text-gray-400 hover:bg-gray-100 active:bg-gray-200 text-gray-500 dark:hover:bg-gray-600 dark:active:bg-gray-700"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><div class="pre_code__KcFrc"><code data-language="tsx" data-theme="light"><span class="line"><span style="color:#D73A49">const</span><span style="color:#24292E"> </span><span style="color:#6F42C1">handleDragStart</span><span style="color:#24292E"> </span><span style="color:#D73A49">=</span><span style="color:#24292E"> (</span><span style="color:#E36209">e</span><span style="color:#D73A49">:</span><span style="color:#24292E"> </span><span style="color:#6F42C1">Event</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#24292E">  </span><span style="color:#D73A49">const</span><span style="color:#24292E"> </span><span style="color:#005CC5">index</span><span style="color:#24292E"> </span><span style="color:#D73A49">=</span><span style="color:#24292E"> </span><span style="color:#6F42C1">getTableCellIndex</span><span style="color:#24292E">(e);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E">  </span><span style="color:#D73A49">if</span><span style="color:#24292E"> (index </span><span style="color:#D73A49">===</span><span style="color:#24292E"> </span><span style="color:#005CC5">null</span><span style="color:#24292E">) {</span></span>
<span class="line"><span style="color:#24292E">    </span><span style="color:#D73A49">return</span><span style="color:#24292E">;</span></span>
<span class="line"><span style="color:#24292E">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E">  </span><span style="color:#D73A49">if</span><span style="color:#24292E"> (</span><span style="color:#6F42C1">isMouseEvent</span><span style="color:#24292E">(e) </span><span style="color:#D73A49">&amp;&amp;</span><span style="color:#24292E"> e.buttons </span><span style="color:#D73A49">!==</span><span style="color:#24292E"> </span><span style="color:#005CC5">1</span><span style="color:#24292E">) {</span></span>
<span class="line"><span style="color:#24292E">    </span><span style="color:#D73A49">return</span><span style="color:#24292E">;</span></span>
<span class="line"><span style="color:#24292E">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E">  </span><span style="color:#D73A49">if</span><span style="color:#24292E"> (</span><span style="color:#6F42C1">isTouchEvent</span><span style="color:#24292E">(e) </span><span style="color:#D73A49">&amp;&amp;</span><span style="color:#24292E"> e.cancelable) {</span></span>
<span class="line"><span style="color:#24292E">    e.</span><span style="color:#6F42C1">preventDefault</span><span style="color:#24292E">();</span></span>
<span class="line"><span style="color:#24292E">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E">  </span><span style="color:#D73A49">const</span><span style="color:#24292E"> { </span><span style="color:#005CC5">rowIndex</span><span style="color:#24292E">, </span><span style="color:#005CC5">colIndex</span><span style="color:#24292E"> } </span><span style="color:#D73A49">=</span><span style="color:#24292E"> index;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E">  startTable.current </span><span style="color:#D73A49">=</span><span style="color:#24292E"> [</span><span style="color:#D73A49">...</span><span style="color:#24292E">value];</span></span>
<span class="line"><span style="color:#24292E">  startIndex.current </span><span style="color:#D73A49">=</span><span style="color:#24292E"> </span><span style="color:#6F42C1">convertIndexToString</span><span style="color:#24292E">(rowIndex, colIndex);</span></span>
<span class="line"><span style="color:#24292E">  mode.current </span><span style="color:#D73A49">=</span><span style="color:#24292E"> </span><span style="color:#D73A49">!</span><span style="color:#24292E">value[rowIndex][colIndex];</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E">  </span><span style="color:#D73A49">const</span><span style="color:#24292E"> </span><span style="color:#005CC5">newValue</span><span style="color:#24292E"> </span><span style="color:#D73A49">=</span><span style="color:#24292E"> [</span><span style="color:#D73A49">...</span><span style="color:#24292E">value];</span></span>
<span class="line"><span style="color:#24292E">  newValue[rowIndex][colIndex] </span><span style="color:#D73A49">=</span><span style="color:#24292E"> mode.current;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E">  </span><span style="color:#6F42C1">setValue</span><span style="color:#24292E">(newValue);</span></span>
<span class="line"><span style="color:#24292E">};</span></span></code></div></pre></div>
<p>드래그를 시작할 때 실행되는 함수입니다. 먼저 발생한 이벤트로부터 <code>&lt;td /&gt;</code>의 row, col 인덱스를 가져옵니다. 위 함수를 요약하면 다음과 같습니다.</p>
<ol>
<li>가져온 인덱스가 유효하지 않다면 함수를 종료합니다.</li>
<li>마우스 이벤트일 때, 버튼의 종류가 <a href="https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent/buttons">Primary button</a>(좌 클릭)이 아니면 종료합니다.</li>
<li>이벤트의 종류가 터치 이벤트라면 드래그 동안 기본 동작인 스크롤을 비활성화합니다.</li>
<li><code>startTable</code>, <code>startIndex</code>, <code>mode</code>에 각각 시작 테이블, 시작 인덱스, 드래그 모드를 기록합니다</li>
<li><code>value</code>를 업데이트합니다.</li>
</ol>
<br/>
<h4 id="handledragmove"><a aria-hidden="true" tabindex="-1" href="#handledragmove"><span class="icon icon-link"></span></a>handleDragMove</h4>
<div data-rehype-pretty-code-fragment=""><pre data-language="tsx" data-theme="dark" class="pre_pre__iJ9A8 group"><div data-language="tsx" class="pre_label__h_sWI">tsx</div><div class="pre_button-wrapper__UqcNw group-hover:opacity-100"><button class="transition-all rounded-md p-2 text-gray-400 hover:bg-gray-100 active:bg-gray-200 text-gray-500 dark:hover:bg-gray-600 dark:active:bg-gray-700"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><div class="pre_code__KcFrc"><code data-language="tsx" data-theme="dark"><span class="line"><span style="color:#F97583">const</span><span style="color:#E1E4E8"> </span><span style="color:#B392F0">handleDragMove</span><span style="color:#E1E4E8"> </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> (</span><span style="color:#FFAB70">e</span><span style="color:#F97583">:</span><span style="color:#E1E4E8"> </span><span style="color:#B392F0">Event</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">=&gt;</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">  </span><span style="color:#F97583">if</span><span style="color:#E1E4E8"> (startIndex.current </span><span style="color:#F97583">===</span><span style="color:#E1E4E8"> </span><span style="color:#9ECBFF">&#x27;&#x27;</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#E1E4E8">    </span><span style="color:#F97583">return</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">  </span><span style="color:#F97583">if</span><span style="color:#E1E4E8"> (</span><span style="color:#B392F0">isMouseEvent</span><span style="color:#E1E4E8">(e) </span><span style="color:#F97583">&amp;&amp;</span><span style="color:#E1E4E8"> e.buttons </span><span style="color:#F97583">!==</span><span style="color:#E1E4E8"> </span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#E1E4E8">    </span><span style="color:#F97583">return</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">  </span><span style="color:#F97583">const</span><span style="color:#E1E4E8"> </span><span style="color:#79B8FF">index</span><span style="color:#E1E4E8"> </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> </span><span style="color:#B392F0">getTableCellIndex</span><span style="color:#E1E4E8">(e);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">  </span><span style="color:#F97583">if</span><span style="color:#E1E4E8"> (index </span><span style="color:#F97583">===</span><span style="color:#E1E4E8"> </span><span style="color:#79B8FF">null</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#E1E4E8">    </span><span style="color:#F97583">return</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">  </span><span style="color:#F97583">const</span><span style="color:#E1E4E8"> { </span><span style="color:#79B8FF">rowIndex</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">colIndex</span><span style="color:#E1E4E8"> } </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> index;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">  </span><span style="color:#F97583">const</span><span style="color:#E1E4E8"> </span><span style="color:#79B8FF">indexString</span><span style="color:#E1E4E8"> </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> </span><span style="color:#B392F0">convertIndexToString</span><span style="color:#E1E4E8">(rowIndex, colIndex);</span></span>
<span class="line"><span style="color:#E1E4E8">  </span><span style="color:#F97583">const</span><span style="color:#E1E4E8"> </span><span style="color:#79B8FF">isSameAsPrevIndex</span><span style="color:#E1E4E8"> </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> indexString </span><span style="color:#F97583">===</span><span style="color:#E1E4E8"> currentIndex.current;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">  </span><span style="color:#F97583">if</span><span style="color:#E1E4E8"> (isSameAsPrevIndex) {</span></span>
<span class="line"><span style="color:#E1E4E8">    </span><span style="color:#F97583">return</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">  currentIndex.current </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> indexString;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">  </span><span style="color:#F97583">const</span><span style="color:#E1E4E8"> [</span><span style="color:#79B8FF">startRowIndex</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">startColIndex</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> </span><span style="color:#B392F0">convertStringToIndex</span><span style="color:#E1E4E8">(startIndex.current);</span></span>
<span class="line"><span style="color:#E1E4E8">  </span><span style="color:#F97583">const</span><span style="color:#E1E4E8"> [</span><span style="color:#79B8FF">minRow</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">maxRow</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [startRowIndex, rowIndex].</span><span style="color:#B392F0">sort</span><span style="color:#E1E4E8">((</span><span style="color:#FFAB70">a</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">b</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">=&gt;</span><span style="color:#E1E4E8"> a </span><span style="color:#F97583">-</span><span style="color:#E1E4E8"> b);</span></span>
<span class="line"><span style="color:#E1E4E8">  </span><span style="color:#F97583">const</span><span style="color:#E1E4E8"> [</span><span style="color:#79B8FF">minCol</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">maxCol</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [startColIndex, colIndex].</span><span style="color:#B392F0">sort</span><span style="color:#E1E4E8">((</span><span style="color:#FFAB70">a</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">b</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">=&gt;</span><span style="color:#E1E4E8"> a </span><span style="color:#F97583">-</span><span style="color:#E1E4E8"> b);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">  </span><span style="color:#F97583">const</span><span style="color:#E1E4E8"> </span><span style="color:#79B8FF">newValue</span><span style="color:#E1E4E8"> </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [</span><span style="color:#F97583">...</span><span style="color:#E1E4E8">value];</span></span>
<span class="line"><span style="color:#E1E4E8">  newValue.</span><span style="color:#B392F0">forEach</span><span style="color:#E1E4E8">((</span><span style="color:#FFAB70">r</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">i</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">=&gt;</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">    r.</span><span style="color:#B392F0">forEach</span><span style="color:#E1E4E8">((</span><span style="color:#FFAB70">_</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">j</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">=&gt;</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">      </span><span style="color:#F97583">if</span><span style="color:#E1E4E8"> (i </span><span style="color:#F97583">&lt;</span><span style="color:#E1E4E8"> minRow </span><span style="color:#F97583">||</span><span style="color:#E1E4E8"> i </span><span style="color:#F97583">&gt;</span><span style="color:#E1E4E8"> maxRow </span><span style="color:#F97583">||</span><span style="color:#E1E4E8"> j </span><span style="color:#F97583">&lt;</span><span style="color:#E1E4E8"> minCol </span><span style="color:#F97583">||</span><span style="color:#E1E4E8"> j </span><span style="color:#F97583">&gt;</span><span style="color:#E1E4E8"> maxCol) {</span></span>
<span class="line"><span style="color:#E1E4E8">        newValue[i][j] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> startTable.current[i][j];</span></span>
<span class="line"><span style="color:#E1E4E8">      } </span><span style="color:#F97583">else</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">        newValue[i][j] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> mode.current;</span></span>
<span class="line"><span style="color:#E1E4E8">      }</span></span>
<span class="line"><span style="color:#E1E4E8">    });</span></span>
<span class="line"><span style="color:#E1E4E8">  });</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">  </span><span style="color:#B392F0">setValue</span><span style="color:#E1E4E8">(newValue);</span></span>
<span class="line"><span style="color:#E1E4E8">};</span></span></code></div></pre><pre data-language="tsx" data-theme="light" class="pre_pre__iJ9A8 group"><div data-language="tsx" class="pre_label__h_sWI">tsx</div><div class="pre_button-wrapper__UqcNw group-hover:opacity-100"><button class="transition-all rounded-md p-2 text-gray-400 hover:bg-gray-100 active:bg-gray-200 text-gray-500 dark:hover:bg-gray-600 dark:active:bg-gray-700"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><div class="pre_code__KcFrc"><code data-language="tsx" data-theme="light"><span class="line"><span style="color:#D73A49">const</span><span style="color:#24292E"> </span><span style="color:#6F42C1">handleDragMove</span><span style="color:#24292E"> </span><span style="color:#D73A49">=</span><span style="color:#24292E"> (</span><span style="color:#E36209">e</span><span style="color:#D73A49">:</span><span style="color:#24292E"> </span><span style="color:#6F42C1">Event</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#24292E">  </span><span style="color:#D73A49">if</span><span style="color:#24292E"> (startIndex.current </span><span style="color:#D73A49">===</span><span style="color:#24292E"> </span><span style="color:#032F62">&#x27;&#x27;</span><span style="color:#24292E">) {</span></span>
<span class="line"><span style="color:#24292E">    </span><span style="color:#D73A49">return</span><span style="color:#24292E">;</span></span>
<span class="line"><span style="color:#24292E">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E">  </span><span style="color:#D73A49">if</span><span style="color:#24292E"> (</span><span style="color:#6F42C1">isMouseEvent</span><span style="color:#24292E">(e) </span><span style="color:#D73A49">&amp;&amp;</span><span style="color:#24292E"> e.buttons </span><span style="color:#D73A49">!==</span><span style="color:#24292E"> </span><span style="color:#005CC5">1</span><span style="color:#24292E">) {</span></span>
<span class="line"><span style="color:#24292E">    </span><span style="color:#D73A49">return</span><span style="color:#24292E">;</span></span>
<span class="line"><span style="color:#24292E">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E">  </span><span style="color:#D73A49">const</span><span style="color:#24292E"> </span><span style="color:#005CC5">index</span><span style="color:#24292E"> </span><span style="color:#D73A49">=</span><span style="color:#24292E"> </span><span style="color:#6F42C1">getTableCellIndex</span><span style="color:#24292E">(e);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E">  </span><span style="color:#D73A49">if</span><span style="color:#24292E"> (index </span><span style="color:#D73A49">===</span><span style="color:#24292E"> </span><span style="color:#005CC5">null</span><span style="color:#24292E">) {</span></span>
<span class="line"><span style="color:#24292E">    </span><span style="color:#D73A49">return</span><span style="color:#24292E">;</span></span>
<span class="line"><span style="color:#24292E">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E">  </span><span style="color:#D73A49">const</span><span style="color:#24292E"> { </span><span style="color:#005CC5">rowIndex</span><span style="color:#24292E">, </span><span style="color:#005CC5">colIndex</span><span style="color:#24292E"> } </span><span style="color:#D73A49">=</span><span style="color:#24292E"> index;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E">  </span><span style="color:#D73A49">const</span><span style="color:#24292E"> </span><span style="color:#005CC5">indexString</span><span style="color:#24292E"> </span><span style="color:#D73A49">=</span><span style="color:#24292E"> </span><span style="color:#6F42C1">convertIndexToString</span><span style="color:#24292E">(rowIndex, colIndex);</span></span>
<span class="line"><span style="color:#24292E">  </span><span style="color:#D73A49">const</span><span style="color:#24292E"> </span><span style="color:#005CC5">isSameAsPrevIndex</span><span style="color:#24292E"> </span><span style="color:#D73A49">=</span><span style="color:#24292E"> indexString </span><span style="color:#D73A49">===</span><span style="color:#24292E"> currentIndex.current;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E">  </span><span style="color:#D73A49">if</span><span style="color:#24292E"> (isSameAsPrevIndex) {</span></span>
<span class="line"><span style="color:#24292E">    </span><span style="color:#D73A49">return</span><span style="color:#24292E">;</span></span>
<span class="line"><span style="color:#24292E">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E">  currentIndex.current </span><span style="color:#D73A49">=</span><span style="color:#24292E"> indexString;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E">  </span><span style="color:#D73A49">const</span><span style="color:#24292E"> [</span><span style="color:#005CC5">startRowIndex</span><span style="color:#24292E">, </span><span style="color:#005CC5">startColIndex</span><span style="color:#24292E">] </span><span style="color:#D73A49">=</span><span style="color:#24292E"> </span><span style="color:#6F42C1">convertStringToIndex</span><span style="color:#24292E">(startIndex.current);</span></span>
<span class="line"><span style="color:#24292E">  </span><span style="color:#D73A49">const</span><span style="color:#24292E"> [</span><span style="color:#005CC5">minRow</span><span style="color:#24292E">, </span><span style="color:#005CC5">maxRow</span><span style="color:#24292E">] </span><span style="color:#D73A49">=</span><span style="color:#24292E"> [startRowIndex, rowIndex].</span><span style="color:#6F42C1">sort</span><span style="color:#24292E">((</span><span style="color:#E36209">a</span><span style="color:#24292E">, </span><span style="color:#E36209">b</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> a </span><span style="color:#D73A49">-</span><span style="color:#24292E"> b);</span></span>
<span class="line"><span style="color:#24292E">  </span><span style="color:#D73A49">const</span><span style="color:#24292E"> [</span><span style="color:#005CC5">minCol</span><span style="color:#24292E">, </span><span style="color:#005CC5">maxCol</span><span style="color:#24292E">] </span><span style="color:#D73A49">=</span><span style="color:#24292E"> [startColIndex, colIndex].</span><span style="color:#6F42C1">sort</span><span style="color:#24292E">((</span><span style="color:#E36209">a</span><span style="color:#24292E">, </span><span style="color:#E36209">b</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> a </span><span style="color:#D73A49">-</span><span style="color:#24292E"> b);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E">  </span><span style="color:#D73A49">const</span><span style="color:#24292E"> </span><span style="color:#005CC5">newValue</span><span style="color:#24292E"> </span><span style="color:#D73A49">=</span><span style="color:#24292E"> [</span><span style="color:#D73A49">...</span><span style="color:#24292E">value];</span></span>
<span class="line"><span style="color:#24292E">  newValue.</span><span style="color:#6F42C1">forEach</span><span style="color:#24292E">((</span><span style="color:#E36209">r</span><span style="color:#24292E">, </span><span style="color:#E36209">i</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#24292E">    r.</span><span style="color:#6F42C1">forEach</span><span style="color:#24292E">((</span><span style="color:#E36209">_</span><span style="color:#24292E">, </span><span style="color:#E36209">j</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#24292E">      </span><span style="color:#D73A49">if</span><span style="color:#24292E"> (i </span><span style="color:#D73A49">&lt;</span><span style="color:#24292E"> minRow </span><span style="color:#D73A49">||</span><span style="color:#24292E"> i </span><span style="color:#D73A49">&gt;</span><span style="color:#24292E"> maxRow </span><span style="color:#D73A49">||</span><span style="color:#24292E"> j </span><span style="color:#D73A49">&lt;</span><span style="color:#24292E"> minCol </span><span style="color:#D73A49">||</span><span style="color:#24292E"> j </span><span style="color:#D73A49">&gt;</span><span style="color:#24292E"> maxCol) {</span></span>
<span class="line"><span style="color:#24292E">        newValue[i][j] </span><span style="color:#D73A49">=</span><span style="color:#24292E"> startTable.current[i][j];</span></span>
<span class="line"><span style="color:#24292E">      } </span><span style="color:#D73A49">else</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#24292E">        newValue[i][j] </span><span style="color:#D73A49">=</span><span style="color:#24292E"> mode.current;</span></span>
<span class="line"><span style="color:#24292E">      }</span></span>
<span class="line"><span style="color:#24292E">    });</span></span>
<span class="line"><span style="color:#24292E">  });</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E">  </span><span style="color:#6F42C1">setValue</span><span style="color:#24292E">(newValue);</span></span>
<span class="line"><span style="color:#24292E">};</span></span></code></div></pre></div>
<p>드래그 중일 때 실행되는 함수입니다. 위 함수를 요약하면 다음과 같습니다.</p>
<ol>
<li><code>startIndex</code>가 비어있다면 종료합니다.</li>
<li>마우스 이벤트일 때, 마우스 버튼의 종류가 Primary button 이 아니면 종료합니다.</li>
<li>이벤트로부터 가져온 인덱스가 유효하지 않다면 종료합니다.</li>
<li>이벤트로부터 가져온 인덱스가 <code>currentIndex</code>와 같다면 종료합니다.</li>
<li><code>currentIndex</code>를 업데이트합니다.</li>
<li><code>startIndex</code>와 현재의 인덱스 사이의 모든 값을 <code>mode</code>로 설정합니다.</li>
<li><code>startIndex</code>와 현재의 인덱스 범위 밖에 있는 모든 값은 <code>startTable</code>의 맵핑되는 값으로 설정합니다.</li>
</ol>
<p>7번은 드래그를 했다가 다시 되돌리는 동작을 할 때 원래의 값으로 초기화 하기 위함입니다.</p>
<h4 id="handledragend"><a aria-hidden="true" tabindex="-1" href="#handledragend"><span class="icon icon-link"></span></a>handleDragEnd</h4>
<div data-rehype-pretty-code-fragment=""><pre data-language="tsx" data-theme="dark" class="pre_pre__iJ9A8 group"><div data-language="tsx" class="pre_label__h_sWI">tsx</div><div class="pre_button-wrapper__UqcNw group-hover:opacity-100"><button class="transition-all rounded-md p-2 text-gray-400 hover:bg-gray-100 active:bg-gray-200 text-gray-500 dark:hover:bg-gray-600 dark:active:bg-gray-700"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><div class="pre_code__KcFrc"><code data-language="tsx" data-theme="dark"><span class="line"><span style="color:#F97583">const</span><span style="color:#E1E4E8"> </span><span style="color:#B392F0">handleDragEnd</span><span style="color:#E1E4E8"> </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> (</span><span style="color:#FFAB70">e</span><span style="color:#F97583">:</span><span style="color:#E1E4E8"> </span><span style="color:#B392F0">Event</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">=&gt;</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">  startIndex.current </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> </span><span style="color:#9ECBFF">&#x27;&#x27;</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">  currentIndex.current </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> </span><span style="color:#9ECBFF">&#x27;&#x27;</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">  startTable.current </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [];</span></span>
<span class="line"><span style="color:#E1E4E8">  mode.current </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> </span><span style="color:#79B8FF">false</span><span style="color:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">  </span><span style="color:#F97583">if</span><span style="color:#E1E4E8"> (e.cancelable) {</span></span>
<span class="line"><span style="color:#E1E4E8">    e.</span><span style="color:#B392F0">preventDefault</span><span style="color:#E1E4E8">();</span></span>
<span class="line"><span style="color:#E1E4E8">  }</span></span>
<span class="line"><span style="color:#E1E4E8">};</span></span></code></div></pre><pre data-language="tsx" data-theme="light" class="pre_pre__iJ9A8 group"><div data-language="tsx" class="pre_label__h_sWI">tsx</div><div class="pre_button-wrapper__UqcNw group-hover:opacity-100"><button class="transition-all rounded-md p-2 text-gray-400 hover:bg-gray-100 active:bg-gray-200 text-gray-500 dark:hover:bg-gray-600 dark:active:bg-gray-700"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><div class="pre_code__KcFrc"><code data-language="tsx" data-theme="light"><span class="line"><span style="color:#D73A49">const</span><span style="color:#24292E"> </span><span style="color:#6F42C1">handleDragEnd</span><span style="color:#24292E"> </span><span style="color:#D73A49">=</span><span style="color:#24292E"> (</span><span style="color:#E36209">e</span><span style="color:#D73A49">:</span><span style="color:#24292E"> </span><span style="color:#6F42C1">Event</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#24292E">  startIndex.current </span><span style="color:#D73A49">=</span><span style="color:#24292E"> </span><span style="color:#032F62">&#x27;&#x27;</span><span style="color:#24292E">;</span></span>
<span class="line"><span style="color:#24292E">  currentIndex.current </span><span style="color:#D73A49">=</span><span style="color:#24292E"> </span><span style="color:#032F62">&#x27;&#x27;</span><span style="color:#24292E">;</span></span>
<span class="line"><span style="color:#24292E">  startTable.current </span><span style="color:#D73A49">=</span><span style="color:#24292E"> [];</span></span>
<span class="line"><span style="color:#24292E">  mode.current </span><span style="color:#D73A49">=</span><span style="color:#24292E"> </span><span style="color:#005CC5">false</span><span style="color:#24292E">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E">  </span><span style="color:#D73A49">if</span><span style="color:#24292E"> (e.cancelable) {</span></span>
<span class="line"><span style="color:#24292E">    e.</span><span style="color:#6F42C1">preventDefault</span><span style="color:#24292E">();</span></span>
<span class="line"><span style="color:#24292E">  }</span></span>
<span class="line"><span style="color:#24292E">};</span></span></code></div></pre></div>
<p><code>handleDragEnd</code>는 간단합니다. <code>ref</code>들을 초기화 해줍니다. 또 터치 이벤트일 때에는 앞서 설명했듯, <code>touchstart -&gt; touchend</code>이후 마우스 이벤트가 발생합니다. 따라서 <code>e.preventDefult()</code>로 마우스 이벤트가 발생하는 기본 동작을 막아주었습니다.</p>
<h4 id="이벤트-붙이기"><a aria-hidden="true" tabindex="-1" href="#이벤트-붙이기"><span class="icon icon-link"></span></a>이벤트 붙이기</h4>
<div data-rehype-pretty-code-fragment=""><pre data-language="tsx" data-theme="dark" class="pre_pre__iJ9A8 group"><div data-language="tsx" class="pre_label__h_sWI">tsx</div><div class="pre_button-wrapper__UqcNw group-hover:opacity-100"><button class="transition-all rounded-md p-2 text-gray-400 hover:bg-gray-100 active:bg-gray-200 text-gray-500 dark:hover:bg-gray-600 dark:active:bg-gray-700"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><div class="pre_code__KcFrc"><code data-language="tsx" data-theme="dark"><span class="line"><span style="color:#F97583">...</span></span>
<span class="line"><span style="color:#E1E4E8">    &lt;</span><span style="color:#79B8FF">Table</span></span>
<span class="line"><span style="color:#E1E4E8">      </span><span style="color:#B392F0">onTouchStart</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">{handleDragStart}</span></span>
<span class="line"><span style="color:#E1E4E8">      </span><span style="color:#B392F0">onMouseDown</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">{handleDragStart}</span></span>
<span class="line"><span style="color:#E1E4E8">      </span><span style="color:#B392F0">onTouchMove</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">{handleDragMove}</span></span>
<span class="line"><span style="color:#E1E4E8">      </span><span style="color:#B392F0">onMouseOver</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">{handleDragMove}</span></span>
<span class="line"><span style="color:#E1E4E8">      </span><span style="color:#B392F0">onTouchEnd</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">{handleDragEnd}</span></span>
<span class="line"><span style="color:#E1E4E8">      </span><span style="color:#B392F0">onMouseUp</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">{handleDragEnd}</span></span>
<span class="line"><span style="color:#E1E4E8">    &gt;</span></span>
<span class="line"><span style="color:#E1E4E8">...</span></span></code></div></pre><pre data-language="tsx" data-theme="light" class="pre_pre__iJ9A8 group"><div data-language="tsx" class="pre_label__h_sWI">tsx</div><div class="pre_button-wrapper__UqcNw group-hover:opacity-100"><button class="transition-all rounded-md p-2 text-gray-400 hover:bg-gray-100 active:bg-gray-200 text-gray-500 dark:hover:bg-gray-600 dark:active:bg-gray-700"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><div class="pre_code__KcFrc"><code data-language="tsx" data-theme="light"><span class="line"><span style="color:#D73A49">...</span></span>
<span class="line"><span style="color:#24292E">    &lt;</span><span style="color:#005CC5">Table</span></span>
<span class="line"><span style="color:#24292E">      </span><span style="color:#6F42C1">onTouchStart</span><span style="color:#D73A49">=</span><span style="color:#24292E">{handleDragStart}</span></span>
<span class="line"><span style="color:#24292E">      </span><span style="color:#6F42C1">onMouseDown</span><span style="color:#D73A49">=</span><span style="color:#24292E">{handleDragStart}</span></span>
<span class="line"><span style="color:#24292E">      </span><span style="color:#6F42C1">onTouchMove</span><span style="color:#D73A49">=</span><span style="color:#24292E">{handleDragMove}</span></span>
<span class="line"><span style="color:#24292E">      </span><span style="color:#6F42C1">onMouseOver</span><span style="color:#D73A49">=</span><span style="color:#24292E">{handleDragMove}</span></span>
<span class="line"><span style="color:#24292E">      </span><span style="color:#6F42C1">onTouchEnd</span><span style="color:#D73A49">=</span><span style="color:#24292E">{handleDragEnd}</span></span>
<span class="line"><span style="color:#24292E">      </span><span style="color:#6F42C1">onMouseUp</span><span style="color:#D73A49">=</span><span style="color:#24292E">{handleDragEnd}</span></span>
<span class="line"><span style="color:#24292E">    &gt;</span></span>
<span class="line"><span style="color:#24292E">...</span></span></code></div></pre></div>
<p>이렇게 만든 핸들러 함수들을 각 이벤트 처리기에 맞게 붙여 드래그 테이블을 완성했습니다.</p>
<br/>
<h3 id="구현-팁"><a aria-hidden="true" tabindex="-1" href="#구현-팁"><span class="icon icon-link"></span></a>구현 팁</h3>
<h4 id="테이블-row-인덱스-가져오기"><a aria-hidden="true" tabindex="-1" href="#테이블-row-인덱스-가져오기"><span class="icon icon-link"></span></a>테이블 Row 인덱스 가져오기</h4>
<div data-rehype-pretty-code-fragment=""><pre data-language="ts" data-theme="dark" class="pre_pre__iJ9A8 group"><div data-language="ts" class="pre_label__h_sWI">ts</div><div class="pre_button-wrapper__UqcNw group-hover:opacity-100"><button class="transition-all rounded-md p-2 text-gray-400 hover:bg-gray-100 active:bg-gray-200 text-gray-500 dark:hover:bg-gray-600 dark:active:bg-gray-700"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><div class="pre_code__KcFrc"><code data-language="ts" data-theme="dark"><span class="line"><span style="color:#F97583">const</span><span style="color:#E1E4E8"> </span><span style="color:#79B8FF">tr</span><span style="color:#E1E4E8"> </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> target.parentNode;</span></span>
<span class="line"><span style="color:#E1E4E8">rowIndex </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> tr.sectionRowIndex;</span></span></code></div></pre><pre data-language="ts" data-theme="light" class="pre_pre__iJ9A8 group"><div data-language="ts" class="pre_label__h_sWI">ts</div><div class="pre_button-wrapper__UqcNw group-hover:opacity-100"><button class="transition-all rounded-md p-2 text-gray-400 hover:bg-gray-100 active:bg-gray-200 text-gray-500 dark:hover:bg-gray-600 dark:active:bg-gray-700"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><div class="pre_code__KcFrc"><code data-language="ts" data-theme="light"><span class="line"><span style="color:#D73A49">const</span><span style="color:#24292E"> </span><span style="color:#005CC5">tr</span><span style="color:#24292E"> </span><span style="color:#D73A49">=</span><span style="color:#24292E"> target.parentNode;</span></span>
<span class="line"><span style="color:#24292E">rowIndex </span><span style="color:#D73A49">=</span><span style="color:#24292E"> tr.sectionRowIndex;</span></span></code></div></pre></div>
<p><code>tr</code>의 <code>rowIndex</code>를 가져오기 위해서 보틍 <code>tr.rowIndex</code>를 사용합니다만, 이렇게 되면 <code>table</code>전체를 기준으로 인덱스를 가져옵니다. 만약 <code>thead</code>에 <code>tr</code>가 있다면 <code>thead</code>의 row도 포함됩니다.</p>
<p><code>sectionRowIndex</code>를 사용하면 현재 섹션을 기준으로 <code>rowIndex</code>를 가져옵니다. <code>tbody</code>가 있다면 여기를 기준으로 가져옵니다.</p>
<h4 id="테이블-column-인덱스-가져오기"><a aria-hidden="true" tabindex="-1" href="#테이블-column-인덱스-가져오기"><span class="icon icon-link"></span></a>테이블 Column 인덱스 가져오기</h4>
<div data-rehype-pretty-code-fragment=""><pre data-language="js" data-theme="dark" class="pre_pre__iJ9A8 group"><div data-language="js" class="pre_label__h_sWI">js</div><div class="pre_button-wrapper__UqcNw group-hover:opacity-100"><button class="transition-all rounded-md p-2 text-gray-400 hover:bg-gray-100 active:bg-gray-200 text-gray-500 dark:hover:bg-gray-600 dark:active:bg-gray-700"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><div class="pre_code__KcFrc"><code data-language="js" data-theme="dark"><span class="line"><span style="color:#F97583">const</span><span style="color:#E1E4E8"> </span><span style="color:#79B8FF">tds</span><span style="color:#E1E4E8"> </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> tr.</span><span style="color:#B392F0">querySelectorAll</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#x27;td&#x27;</span><span style="color:#E1E4E8">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">for</span><span style="color:#E1E4E8"> (</span><span style="color:#F97583">let</span><span style="color:#E1E4E8"> i </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> </span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">; i </span><span style="color:#F97583">&lt;</span><span style="color:#E1E4E8"> tds.</span><span style="color:#79B8FF">length</span><span style="color:#E1E4E8">; i</span><span style="color:#F97583">++</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#E1E4E8">  </span><span style="color:#F97583">if</span><span style="color:#E1E4E8"> (tds[i] </span><span style="color:#F97583">===</span><span style="color:#E1E4E8"> target) {</span></span>
<span class="line"><span style="color:#E1E4E8">    colIndex </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> i;</span></span>
<span class="line"><span style="color:#E1E4E8">    </span><span style="color:#F97583">break</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">  }</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></div></pre><pre data-language="js" data-theme="light" class="pre_pre__iJ9A8 group"><div data-language="js" class="pre_label__h_sWI">js</div><div class="pre_button-wrapper__UqcNw group-hover:opacity-100"><button class="transition-all rounded-md p-2 text-gray-400 hover:bg-gray-100 active:bg-gray-200 text-gray-500 dark:hover:bg-gray-600 dark:active:bg-gray-700"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><div class="pre_code__KcFrc"><code data-language="js" data-theme="light"><span class="line"><span style="color:#D73A49">const</span><span style="color:#24292E"> </span><span style="color:#005CC5">tds</span><span style="color:#24292E"> </span><span style="color:#D73A49">=</span><span style="color:#24292E"> tr.</span><span style="color:#6F42C1">querySelectorAll</span><span style="color:#24292E">(</span><span style="color:#032F62">&#x27;td&#x27;</span><span style="color:#24292E">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">for</span><span style="color:#24292E"> (</span><span style="color:#D73A49">let</span><span style="color:#24292E"> i </span><span style="color:#D73A49">=</span><span style="color:#24292E"> </span><span style="color:#005CC5">0</span><span style="color:#24292E">; i </span><span style="color:#D73A49">&lt;</span><span style="color:#24292E"> tds.</span><span style="color:#005CC5">length</span><span style="color:#24292E">; i</span><span style="color:#D73A49">++</span><span style="color:#24292E">) {</span></span>
<span class="line"><span style="color:#24292E">  </span><span style="color:#D73A49">if</span><span style="color:#24292E"> (tds[i] </span><span style="color:#D73A49">===</span><span style="color:#24292E"> target) {</span></span>
<span class="line"><span style="color:#24292E">    colIndex </span><span style="color:#D73A49">=</span><span style="color:#24292E"> i;</span></span>
<span class="line"><span style="color:#24292E">    </span><span style="color:#D73A49">break</span><span style="color:#24292E">;</span></span>
<span class="line"><span style="color:#24292E">  }</span></span>
<span class="line"><span style="color:#24292E">}</span></span></code></div></pre></div>
<p><code>element.cellIndex</code>에서 <code>cellIndex</code>는 <code>th</code>도 포함합니다. <code>th</code>를 포함하고 싶지 않다면 위처럼 직접 <code>tds</code>를 구해야 합니다.</p>
<h4 id="type-guard-만들기"><a aria-hidden="true" tabindex="-1" href="#type-guard-만들기"><span class="icon icon-link"></span></a>type guard 만들기</h4>
<div data-rehype-pretty-code-fragment=""><pre data-language="js" data-theme="dark" class="pre_pre__iJ9A8 group"><div data-language="js" class="pre_label__h_sWI">js</div><div class="pre_button-wrapper__UqcNw group-hover:opacity-100"><button class="transition-all rounded-md p-2 text-gray-400 hover:bg-gray-100 active:bg-gray-200 text-gray-500 dark:hover:bg-gray-600 dark:active:bg-gray-700"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><div class="pre_code__KcFrc"><code data-language="js" data-theme="dark"><span class="line"><span style="color:#F97583">function</span><span style="color:#E1E4E8"> </span><span style="color:#B392F0">isMouseEvent</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">event</span><span style="color:#F97583">:</span><span style="color:#E1E4E8"> </span><span style="color:#B392F0">Event</span><span style="color:#E1E4E8">)</span><span style="color:#F97583">:</span><span style="color:#E1E4E8"> </span><span style="color:#FFAB70">event</span><span style="color:#E1E4E8"> </span><span style="color:#F97583">is</span><span style="color:#E1E4E8"> </span><span style="color:#B392F0">MouseEvent</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">  </span><span style="color:#F97583">return</span><span style="color:#E1E4E8"> event </span><span style="color:#F97583">instanceof</span><span style="color:#E1E4E8"> </span><span style="color:#B392F0">MouseEvent</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">function</span><span style="color:#E1E4E8"> </span><span style="color:#B392F0">isTouchEvent</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">event</span><span style="color:#F97583">:</span><span style="color:#E1E4E8"> </span><span style="color:#B392F0">Event</span><span style="color:#E1E4E8">)</span><span style="color:#F97583">:</span><span style="color:#E1E4E8"> </span><span style="color:#FFAB70">event</span><span style="color:#E1E4E8"> </span><span style="color:#F97583">is</span><span style="color:#E1E4E8"> </span><span style="color:#B392F0">TouchEvent</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">  </span><span style="color:#F97583">return</span><span style="color:#E1E4E8"> </span><span style="color:#9ECBFF">&#x27;ontouchstart&#x27;</span><span style="color:#E1E4E8"> </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> window </span><span style="color:#F97583">&amp;&amp;</span><span style="color:#E1E4E8"> event.type.</span><span style="color:#B392F0">startsWith</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#x27;touch&#x27;</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></div></pre><pre data-language="js" data-theme="light" class="pre_pre__iJ9A8 group"><div data-language="js" class="pre_label__h_sWI">js</div><div class="pre_button-wrapper__UqcNw group-hover:opacity-100"><button class="transition-all rounded-md p-2 text-gray-400 hover:bg-gray-100 active:bg-gray-200 text-gray-500 dark:hover:bg-gray-600 dark:active:bg-gray-700"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><div class="pre_code__KcFrc"><code data-language="js" data-theme="light"><span class="line"><span style="color:#D73A49">function</span><span style="color:#24292E"> </span><span style="color:#6F42C1">isMouseEvent</span><span style="color:#24292E">(</span><span style="color:#E36209">event</span><span style="color:#D73A49">:</span><span style="color:#24292E"> </span><span style="color:#6F42C1">Event</span><span style="color:#24292E">)</span><span style="color:#D73A49">:</span><span style="color:#24292E"> </span><span style="color:#E36209">event</span><span style="color:#24292E"> </span><span style="color:#D73A49">is</span><span style="color:#24292E"> </span><span style="color:#6F42C1">MouseEvent</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#24292E">  </span><span style="color:#D73A49">return</span><span style="color:#24292E"> event </span><span style="color:#D73A49">instanceof</span><span style="color:#24292E"> </span><span style="color:#6F42C1">MouseEvent</span><span style="color:#24292E">;</span></span>
<span class="line"><span style="color:#24292E">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">function</span><span style="color:#24292E"> </span><span style="color:#6F42C1">isTouchEvent</span><span style="color:#24292E">(</span><span style="color:#E36209">event</span><span style="color:#D73A49">:</span><span style="color:#24292E"> </span><span style="color:#6F42C1">Event</span><span style="color:#24292E">)</span><span style="color:#D73A49">:</span><span style="color:#24292E"> </span><span style="color:#E36209">event</span><span style="color:#24292E"> </span><span style="color:#D73A49">is</span><span style="color:#24292E"> </span><span style="color:#6F42C1">TouchEvent</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#24292E">  </span><span style="color:#D73A49">return</span><span style="color:#24292E"> </span><span style="color:#032F62">&#x27;ontouchstart&#x27;</span><span style="color:#24292E"> </span><span style="color:#D73A49">in</span><span style="color:#24292E"> window </span><span style="color:#D73A49">&amp;&amp;</span><span style="color:#24292E"> event.type.</span><span style="color:#6F42C1">startsWith</span><span style="color:#24292E">(</span><span style="color:#032F62">&#x27;touch&#x27;</span><span style="color:#24292E">);</span></span>
<span class="line"><span style="color:#24292E">}</span></span></code></div></pre></div>
<br/>
<hr/>
<h2 id="리팩토링"><a aria-hidden="true" tabindex="-1" href="#리팩토링"><span class="icon icon-link"></span></a>리팩토링</h2>
<p>이대로도 충분히 괜찮지만 몇 가지 아쉬운 점들이 있습니다. 마지막으로 리팩토링 과정을 설명드리겠습니다.</p>
<h3 id="문제-인식하기"><a aria-hidden="true" tabindex="-1" href="#문제-인식하기"><span class="icon icon-link"></span></a>문제 인식하기</h3>
<div data-rehype-pretty-code-fragment=""><pre data-language="tsx" data-theme="dark" class="pre_pre__iJ9A8 group"><div data-language="tsx" class="pre_label__h_sWI">tsx</div><div class="pre_button-wrapper__UqcNw group-hover:opacity-100"><button class="transition-all rounded-md p-2 text-gray-400 hover:bg-gray-100 active:bg-gray-200 text-gray-500 dark:hover:bg-gray-600 dark:active:bg-gray-700"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><div class="pre_code__KcFrc"><code data-language="tsx" data-theme="dark"><span class="line"><span style="color:#F97583">function</span><span style="color:#E1E4E8"> </span><span style="color:#B392F0">DraggableTable</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">initialValue</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#E1E4E8">  </span><span style="color:#F97583">const</span><span style="color:#E1E4E8"> </span><span style="color:#79B8FF">startIndex</span><span style="color:#E1E4E8"> </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> </span><span style="color:#B392F0">useRef</span><span style="color:#E1E4E8">&lt;</span><span style="color:#79B8FF">string</span><span style="color:#E1E4E8">&gt;(</span><span style="color:#9ECBFF">&#x27;&#x27;</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#E1E4E8">  </span><span style="color:#F97583">const</span><span style="color:#E1E4E8"> </span><span style="color:#79B8FF">currentIndex</span><span style="color:#E1E4E8"> </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> </span><span style="color:#B392F0">useRef</span><span style="color:#E1E4E8">&lt;</span><span style="color:#79B8FF">string</span><span style="color:#E1E4E8">&gt;(</span><span style="color:#9ECBFF">&#x27;&#x27;</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#E1E4E8">  </span><span style="color:#F97583">const</span><span style="color:#E1E4E8"> </span><span style="color:#79B8FF">startTable</span><span style="color:#E1E4E8"> </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> </span><span style="color:#B392F0">useRef</span><span style="color:#E1E4E8">&lt;</span><span style="color:#79B8FF">boolean</span><span style="color:#E1E4E8">[][]&gt;([]);</span></span>
<span class="line"><span style="color:#E1E4E8">  </span><span style="color:#F97583">const</span><span style="color:#E1E4E8"> </span><span style="color:#79B8FF">mode</span><span style="color:#E1E4E8"> </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> </span><span style="color:#B392F0">useRef</span><span style="color:#E1E4E8">&lt;</span><span style="color:#79B8FF">boolean</span><span style="color:#E1E4E8">&gt;(</span><span style="color:#79B8FF">false</span><span style="color:#E1E4E8">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">  </span><span style="color:#F97583">const</span><span style="color:#E1E4E8"> [</span><span style="color:#79B8FF">value</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">setValue</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> </span><span style="color:#B392F0">useState</span><span style="color:#E1E4E8">&lt;</span><span style="color:#79B8FF">boolean</span><span style="color:#E1E4E8">[][]&gt;(initialValue);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">  </span><span style="color:#6A737D">// ... 생략</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">  </span><span style="color:#F97583">return</span><span style="color:#E1E4E8"> (</span></span>
<span class="line"><span style="color:#E1E4E8">    &lt;</span><span style="color:#79B8FF">Table</span></span>
<span class="line"><span style="color:#E1E4E8">      </span><span style="color:#B392F0">onTouchStart</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">{handleDragStart}</span></span>
<span class="line"><span style="color:#E1E4E8">      </span><span style="color:#B392F0">onMouseDown</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">{handleDragStart}</span></span>
<span class="line"><span style="color:#E1E4E8">      </span><span style="color:#B392F0">onTouchMove</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">{handleDragMove}</span></span>
<span class="line"><span style="color:#E1E4E8">      </span><span style="color:#B392F0">onMouseOver</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">{handleDragMove}</span></span>
<span class="line"><span style="color:#E1E4E8">      </span><span style="color:#B392F0">onTouchEnd</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">{handleDragEnd}</span></span>
<span class="line"><span style="color:#E1E4E8">      </span><span style="color:#B392F0">onMouseUp</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">{handleDragEnd}</span></span>
<span class="line"><span style="color:#E1E4E8">    &gt;</span></span>
<span class="line"><span style="color:#E1E4E8">      &lt;</span><span style="color:#79B8FF">THead</span><span style="color:#E1E4E8">&gt;{</span><span style="color:#6A737D">/* ...생략 */</span><span style="color:#E1E4E8">}&lt;/</span><span style="color:#79B8FF">THead</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">      &lt;</span><span style="color:#79B8FF">TBody</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">        {value.</span><span style="color:#B392F0">map</span><span style="color:#E1E4E8">((</span><span style="color:#FFAB70">row</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">rowIndex</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">=&gt;</span><span style="color:#E1E4E8"> (</span></span>
<span class="line"><span style="color:#E1E4E8">          &lt;</span><span style="color:#79B8FF">TR</span><span style="color:#E1E4E8"> </span><span style="color:#B392F0">key</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">{rowIndex}&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">            &lt;</span><span style="color:#79B8FF">TH</span><span style="color:#E1E4E8">&gt;{time}&lt;/</span><span style="color:#79B8FF">TH</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">            {row.</span><span style="color:#B392F0">map</span><span style="color:#E1E4E8">(() </span><span style="color:#F97583">=&gt;</span><span style="color:#E1E4E8"> (</span></span>
<span class="line"><span style="color:#E1E4E8">              &lt;</span><span style="color:#79B8FF">TD</span><span style="color:#E1E4E8">&gt;&lt;/</span><span style="color:#79B8FF">TD</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">            ))}</span></span>
<span class="line"><span style="color:#E1E4E8">          &lt;/</span><span style="color:#79B8FF">TR</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">        ))}</span></span>
<span class="line"><span style="color:#E1E4E8">      &lt;/</span><span style="color:#79B8FF">TBody</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">    &lt;/</span><span style="color:#79B8FF">Table</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">  );</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></div></pre><pre data-language="tsx" data-theme="light" class="pre_pre__iJ9A8 group"><div data-language="tsx" class="pre_label__h_sWI">tsx</div><div class="pre_button-wrapper__UqcNw group-hover:opacity-100"><button class="transition-all rounded-md p-2 text-gray-400 hover:bg-gray-100 active:bg-gray-200 text-gray-500 dark:hover:bg-gray-600 dark:active:bg-gray-700"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><div class="pre_code__KcFrc"><code data-language="tsx" data-theme="light"><span class="line"><span style="color:#D73A49">function</span><span style="color:#24292E"> </span><span style="color:#6F42C1">DraggableTable</span><span style="color:#24292E">(</span><span style="color:#E36209">initialValue</span><span style="color:#24292E">) {</span></span>
<span class="line"><span style="color:#24292E">  </span><span style="color:#D73A49">const</span><span style="color:#24292E"> </span><span style="color:#005CC5">startIndex</span><span style="color:#24292E"> </span><span style="color:#D73A49">=</span><span style="color:#24292E"> </span><span style="color:#6F42C1">useRef</span><span style="color:#24292E">&lt;</span><span style="color:#005CC5">string</span><span style="color:#24292E">&gt;(</span><span style="color:#032F62">&#x27;&#x27;</span><span style="color:#24292E">);</span></span>
<span class="line"><span style="color:#24292E">  </span><span style="color:#D73A49">const</span><span style="color:#24292E"> </span><span style="color:#005CC5">currentIndex</span><span style="color:#24292E"> </span><span style="color:#D73A49">=</span><span style="color:#24292E"> </span><span style="color:#6F42C1">useRef</span><span style="color:#24292E">&lt;</span><span style="color:#005CC5">string</span><span style="color:#24292E">&gt;(</span><span style="color:#032F62">&#x27;&#x27;</span><span style="color:#24292E">);</span></span>
<span class="line"><span style="color:#24292E">  </span><span style="color:#D73A49">const</span><span style="color:#24292E"> </span><span style="color:#005CC5">startTable</span><span style="color:#24292E"> </span><span style="color:#D73A49">=</span><span style="color:#24292E"> </span><span style="color:#6F42C1">useRef</span><span style="color:#24292E">&lt;</span><span style="color:#005CC5">boolean</span><span style="color:#24292E">[][]&gt;([]);</span></span>
<span class="line"><span style="color:#24292E">  </span><span style="color:#D73A49">const</span><span style="color:#24292E"> </span><span style="color:#005CC5">mode</span><span style="color:#24292E"> </span><span style="color:#D73A49">=</span><span style="color:#24292E"> </span><span style="color:#6F42C1">useRef</span><span style="color:#24292E">&lt;</span><span style="color:#005CC5">boolean</span><span style="color:#24292E">&gt;(</span><span style="color:#005CC5">false</span><span style="color:#24292E">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E">  </span><span style="color:#D73A49">const</span><span style="color:#24292E"> [</span><span style="color:#005CC5">value</span><span style="color:#24292E">, </span><span style="color:#005CC5">setValue</span><span style="color:#24292E">] </span><span style="color:#D73A49">=</span><span style="color:#24292E"> </span><span style="color:#6F42C1">useState</span><span style="color:#24292E">&lt;</span><span style="color:#005CC5">boolean</span><span style="color:#24292E">[][]&gt;(initialValue);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E">  </span><span style="color:#6A737D">// ... 생략</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E">  </span><span style="color:#D73A49">return</span><span style="color:#24292E"> (</span></span>
<span class="line"><span style="color:#24292E">    &lt;</span><span style="color:#005CC5">Table</span></span>
<span class="line"><span style="color:#24292E">      </span><span style="color:#6F42C1">onTouchStart</span><span style="color:#D73A49">=</span><span style="color:#24292E">{handleDragStart}</span></span>
<span class="line"><span style="color:#24292E">      </span><span style="color:#6F42C1">onMouseDown</span><span style="color:#D73A49">=</span><span style="color:#24292E">{handleDragStart}</span></span>
<span class="line"><span style="color:#24292E">      </span><span style="color:#6F42C1">onTouchMove</span><span style="color:#D73A49">=</span><span style="color:#24292E">{handleDragMove}</span></span>
<span class="line"><span style="color:#24292E">      </span><span style="color:#6F42C1">onMouseOver</span><span style="color:#D73A49">=</span><span style="color:#24292E">{handleDragMove}</span></span>
<span class="line"><span style="color:#24292E">      </span><span style="color:#6F42C1">onTouchEnd</span><span style="color:#D73A49">=</span><span style="color:#24292E">{handleDragEnd}</span></span>
<span class="line"><span style="color:#24292E">      </span><span style="color:#6F42C1">onMouseUp</span><span style="color:#D73A49">=</span><span style="color:#24292E">{handleDragEnd}</span></span>
<span class="line"><span style="color:#24292E">    &gt;</span></span>
<span class="line"><span style="color:#24292E">      &lt;</span><span style="color:#005CC5">THead</span><span style="color:#24292E">&gt;{</span><span style="color:#6A737D">/* ...생략 */</span><span style="color:#24292E">}&lt;/</span><span style="color:#005CC5">THead</span><span style="color:#24292E">&gt;</span></span>
<span class="line"><span style="color:#24292E">      &lt;</span><span style="color:#005CC5">TBody</span><span style="color:#24292E">&gt;</span></span>
<span class="line"><span style="color:#24292E">        {value.</span><span style="color:#6F42C1">map</span><span style="color:#24292E">((</span><span style="color:#E36209">row</span><span style="color:#24292E">, </span><span style="color:#E36209">rowIndex</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> (</span></span>
<span class="line"><span style="color:#24292E">          &lt;</span><span style="color:#005CC5">TR</span><span style="color:#24292E"> </span><span style="color:#6F42C1">key</span><span style="color:#D73A49">=</span><span style="color:#24292E">{rowIndex}&gt;</span></span>
<span class="line"><span style="color:#24292E">            &lt;</span><span style="color:#005CC5">TH</span><span style="color:#24292E">&gt;{time}&lt;/</span><span style="color:#005CC5">TH</span><span style="color:#24292E">&gt;</span></span>
<span class="line"><span style="color:#24292E">            {row.</span><span style="color:#6F42C1">map</span><span style="color:#24292E">(() </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> (</span></span>
<span class="line"><span style="color:#24292E">              &lt;</span><span style="color:#005CC5">TD</span><span style="color:#24292E">&gt;&lt;/</span><span style="color:#005CC5">TD</span><span style="color:#24292E">&gt;</span></span>
<span class="line"><span style="color:#24292E">            ))}</span></span>
<span class="line"><span style="color:#24292E">          &lt;/</span><span style="color:#005CC5">TR</span><span style="color:#24292E">&gt;</span></span>
<span class="line"><span style="color:#24292E">        ))}</span></span>
<span class="line"><span style="color:#24292E">      &lt;/</span><span style="color:#005CC5">TBody</span><span style="color:#24292E">&gt;</span></span>
<span class="line"><span style="color:#24292E">    &lt;/</span><span style="color:#005CC5">Table</span><span style="color:#24292E">&gt;</span></span>
<span class="line"><span style="color:#24292E">  );</span></span>
<span class="line"><span style="color:#24292E">}</span></span></code></div></pre></div>
<p>위 코드의 생략된 부분 중 많은 부분은 드래그 테이블과는 관련이 없습니다. 즉, 테이블을 드래그하는 로직을 분리하는 것이 코드 유지보수에 유리할 것입니다. 또 현재는 드래그 테이블 로직이 다른 곳에서 사용될 수 없습니다. 이 문제를 hook 을 만들어 해결했습니다.</p>
<br/>
<h3 id="hook-만들기"><a aria-hidden="true" tabindex="-1" href="#hook-만들기"><span class="icon icon-link"></span></a>Hook 만들기</h3>
<div data-rehype-pretty-code-fragment=""><pre data-language="tsx" data-theme="dark" class="pre_pre__iJ9A8 group"><div data-language="tsx" class="pre_label__h_sWI">tsx</div><div class="pre_button-wrapper__UqcNw group-hover:opacity-100"><button class="transition-all rounded-md p-2 text-gray-400 hover:bg-gray-100 active:bg-gray-200 text-gray-500 dark:hover:bg-gray-600 dark:active:bg-gray-700"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><div class="pre_code__KcFrc"><code data-language="tsx" data-theme="dark"><span class="line"><span style="color:#F97583">export</span><span style="color:#E1E4E8"> </span><span style="color:#F97583">function</span><span style="color:#E1E4E8"> </span><span style="color:#B392F0">useTableDragSelect</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">initialTable</span><span style="color:#F97583">?:</span><span style="color:#E1E4E8"> </span><span style="color:#79B8FF">boolean</span><span style="color:#E1E4E8">[][])</span><span style="color:#F97583">:</span><span style="color:#E1E4E8"> [</span><span style="color:#B392F0">React</span><span style="color:#E1E4E8">.</span><span style="color:#B392F0">RefObject</span><span style="color:#E1E4E8">&lt;</span><span style="color:#B392F0">HTMLTableElement</span><span style="color:#E1E4E8">&gt;, </span><span style="color:#79B8FF">boolean</span><span style="color:#E1E4E8">[][]] {</span></span>
<span class="line"><span style="color:#E1E4E8">  </span><span style="color:#F97583">const</span><span style="color:#E1E4E8"> </span><span style="color:#79B8FF">startIndex</span><span style="color:#E1E4E8"> </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> </span><span style="color:#B392F0">useRef</span><span style="color:#E1E4E8">&lt;</span><span style="color:#79B8FF">string</span><span style="color:#E1E4E8">&gt;(</span><span style="color:#9ECBFF">&#x27;&#x27;</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#E1E4E8">  </span><span style="color:#F97583">const</span><span style="color:#E1E4E8"> </span><span style="color:#79B8FF">currentIndex</span><span style="color:#E1E4E8"> </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> </span><span style="color:#B392F0">useRef</span><span style="color:#E1E4E8">&lt;</span><span style="color:#79B8FF">string</span><span style="color:#E1E4E8">&gt;(</span><span style="color:#9ECBFF">&#x27;&#x27;</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#E1E4E8">  </span><span style="color:#F97583">const</span><span style="color:#E1E4E8"> </span><span style="color:#79B8FF">startTable</span><span style="color:#E1E4E8"> </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> </span><span style="color:#B392F0">useRef</span><span style="color:#E1E4E8">&lt;</span><span style="color:#79B8FF">boolean</span><span style="color:#E1E4E8">[][]&gt;([]);</span></span>
<span class="line"><span style="color:#E1E4E8">  </span><span style="color:#F97583">const</span><span style="color:#E1E4E8"> </span><span style="color:#79B8FF">mode</span><span style="color:#E1E4E8"> </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> </span><span style="color:#B392F0">useRef</span><span style="color:#E1E4E8">&lt;</span><span style="color:#79B8FF">boolean</span><span style="color:#E1E4E8">&gt;(</span><span style="color:#79B8FF">false</span><span style="color:#E1E4E8">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">  </span><span style="color:#F97583">const</span><span style="color:#E1E4E8"> </span><span style="color:#79B8FF">tableRef</span><span style="color:#E1E4E8"> </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> </span><span style="color:#B392F0">useRef</span><span style="color:#E1E4E8">&lt;</span><span style="color:#B392F0">HTMLTableElement</span><span style="color:#E1E4E8">&gt;(</span><span style="color:#79B8FF">null</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#E1E4E8">  </span><span style="color:#F97583">const</span><span style="color:#E1E4E8"> [</span><span style="color:#79B8FF">tableValue</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">setTableValue</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> </span><span style="color:#B392F0">useState</span><span style="color:#E1E4E8">&lt;</span><span style="color:#79B8FF">boolean</span><span style="color:#E1E4E8">[][]&gt;(initialTable </span><span style="color:#F97583">??</span><span style="color:#E1E4E8"> []);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">  </span><span style="color:#6A737D">// ... handler 함수 생략</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">  </span><span style="color:#B392F0">useEffect</span><span style="color:#E1E4E8">(() </span><span style="color:#F97583">=&gt;</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">    </span><span style="color:#F97583">const</span><span style="color:#E1E4E8"> </span><span style="color:#79B8FF">node</span><span style="color:#E1E4E8"> </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> tableRef.current?.</span><span style="color:#B392F0">querySelector</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#x27;tbody&#x27;</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">??</span><span style="color:#E1E4E8"> tableRef.current;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">    </span><span style="color:#B392F0">setTableValue</span><span style="color:#E1E4E8">(initialTable </span><span style="color:#F97583">??</span><span style="color:#E1E4E8"> []);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">    </span><span style="color:#F97583">if</span><span style="color:#E1E4E8"> (</span><span style="color:#F97583">!</span><span style="color:#E1E4E8">initialTable </span><span style="color:#F97583">&amp;&amp;</span><span style="color:#E1E4E8"> node) {</span></span>
<span class="line"><span style="color:#E1E4E8">      </span><span style="color:#F97583">const</span><span style="color:#E1E4E8"> </span><span style="color:#79B8FF">trs</span><span style="color:#E1E4E8"> </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> node.</span><span style="color:#B392F0">querySelectorAll</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#x27;tr&#x27;</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#E1E4E8">      </span><span style="color:#F97583">const</span><span style="color:#E1E4E8"> </span><span style="color:#79B8FF">newTableValues</span><span style="color:#F97583">:</span><span style="color:#E1E4E8"> </span><span style="color:#79B8FF">boolean</span><span style="color:#E1E4E8">[][] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [];</span></span>
<span class="line"><span style="color:#E1E4E8">      trs.</span><span style="color:#B392F0">forEach</span><span style="color:#E1E4E8">((</span><span style="color:#FFAB70">tr</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">i</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">=&gt;</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">        </span><span style="color:#F97583">const</span><span style="color:#E1E4E8"> </span><span style="color:#79B8FF">tds</span><span style="color:#E1E4E8"> </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> tr.</span><span style="color:#B392F0">querySelectorAll</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#x27;td&#x27;</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#E1E4E8">        </span><span style="color:#F97583">const</span><span style="color:#E1E4E8"> </span><span style="color:#79B8FF">row</span><span style="color:#F97583">:</span><span style="color:#E1E4E8"> </span><span style="color:#79B8FF">boolean</span><span style="color:#E1E4E8">[] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [];</span></span>
<span class="line"><span style="color:#E1E4E8">        tds.</span><span style="color:#B392F0">forEach</span><span style="color:#E1E4E8">((</span><span style="color:#FFAB70">td</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">j</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">=&gt;</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">          row.</span><span style="color:#B392F0">push</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">false</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#E1E4E8">        });</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">        </span><span style="color:#F97583">if</span><span style="color:#E1E4E8"> (tds.</span><span style="color:#79B8FF">length</span><span style="color:#E1E4E8"> </span><span style="color:#F97583">&gt;</span><span style="color:#E1E4E8"> </span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#E1E4E8">          newTableValues.</span><span style="color:#B392F0">push</span><span style="color:#E1E4E8">(row);</span></span>
<span class="line"><span style="color:#E1E4E8">        }</span></span>
<span class="line"><span style="color:#E1E4E8">      });</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">      </span><span style="color:#B392F0">setTableValue</span><span style="color:#E1E4E8">(newTableValues);</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#E1E4E8">  }, [initialTable]);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">  </span><span style="color:#B392F0">useEffect</span><span style="color:#E1E4E8">(() </span><span style="color:#F97583">=&gt;</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">    </span><span style="color:#F97583">const</span><span style="color:#E1E4E8"> </span><span style="color:#79B8FF">node</span><span style="color:#E1E4E8"> </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> tableRef.current?.</span><span style="color:#B392F0">querySelector</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#x27;tbody&#x27;</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">??</span><span style="color:#E1E4E8"> tableRef.current;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">    </span><span style="color:#F97583">if</span><span style="color:#E1E4E8"> (node) {</span></span>
<span class="line"><span style="color:#E1E4E8">      node.</span><span style="color:#B392F0">addEventListener</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#x27;touchstart&#x27;</span><span style="color:#E1E4E8">, handlePointerStart);</span></span>
<span class="line"><span style="color:#E1E4E8">      node.</span><span style="color:#B392F0">addEventListener</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#x27;mousedown&#x27;</span><span style="color:#E1E4E8">, handlePointerStart);</span></span>
<span class="line"><span style="color:#E1E4E8">      node.</span><span style="color:#B392F0">addEventListener</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#x27;touchmove&#x27;</span><span style="color:#E1E4E8">, handlePointerMove);</span></span>
<span class="line"><span style="color:#E1E4E8">      node.</span><span style="color:#B392F0">addEventListener</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#x27;mouseover&#x27;</span><span style="color:#E1E4E8">, handlePointerMove);</span></span>
<span class="line"><span style="color:#E1E4E8">      node.</span><span style="color:#B392F0">addEventListener</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#x27;touchend&#x27;</span><span style="color:#E1E4E8">, handlePointerEnd);</span></span>
<span class="line"><span style="color:#E1E4E8">      node.</span><span style="color:#B392F0">addEventListener</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#x27;mouseup&#x27;</span><span style="color:#E1E4E8">, handlePointerEnd);</span></span>
<span class="line"><span style="color:#E1E4E8">      </span><span style="color:#F97583">return</span><span style="color:#E1E4E8"> () </span><span style="color:#F97583">=&gt;</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">        node.</span><span style="color:#B392F0">removeEventListener</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#x27;touchstart&#x27;</span><span style="color:#E1E4E8">, handlePointerStart);</span></span>
<span class="line"><span style="color:#E1E4E8">        node.</span><span style="color:#B392F0">removeEventListener</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#x27;mousedown&#x27;</span><span style="color:#E1E4E8">, handlePointerStart);</span></span>
<span class="line"><span style="color:#E1E4E8">        node.</span><span style="color:#B392F0">removeEventListener</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#x27;touchmove&#x27;</span><span style="color:#E1E4E8">, handlePointerMove);</span></span>
<span class="line"><span style="color:#E1E4E8">        node.</span><span style="color:#B392F0">removeEventListener</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#x27;mouseover&#x27;</span><span style="color:#E1E4E8">, handlePointerMove);</span></span>
<span class="line"><span style="color:#E1E4E8">        node.</span><span style="color:#B392F0">removeEventListener</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#x27;touchend&#x27;</span><span style="color:#E1E4E8">, handlePointerEnd);</span></span>
<span class="line"><span style="color:#E1E4E8">        node.</span><span style="color:#B392F0">removeEventListener</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#x27;mouseup&#x27;</span><span style="color:#E1E4E8">, handlePointerEnd);</span></span>
<span class="line"><span style="color:#E1E4E8">      };</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#E1E4E8">  }, [handlePointerStart, handlePointerMove, handlePointerEnd]);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">  </span><span style="color:#F97583">return</span><span style="color:#E1E4E8"> [tableRef, tableValue];</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></div></pre><pre data-language="tsx" data-theme="light" class="pre_pre__iJ9A8 group"><div data-language="tsx" class="pre_label__h_sWI">tsx</div><div class="pre_button-wrapper__UqcNw group-hover:opacity-100"><button class="transition-all rounded-md p-2 text-gray-400 hover:bg-gray-100 active:bg-gray-200 text-gray-500 dark:hover:bg-gray-600 dark:active:bg-gray-700"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><div class="pre_code__KcFrc"><code data-language="tsx" data-theme="light"><span class="line"><span style="color:#D73A49">export</span><span style="color:#24292E"> </span><span style="color:#D73A49">function</span><span style="color:#24292E"> </span><span style="color:#6F42C1">useTableDragSelect</span><span style="color:#24292E">(</span><span style="color:#E36209">initialTable</span><span style="color:#D73A49">?:</span><span style="color:#24292E"> </span><span style="color:#005CC5">boolean</span><span style="color:#24292E">[][])</span><span style="color:#D73A49">:</span><span style="color:#24292E"> [</span><span style="color:#6F42C1">React</span><span style="color:#24292E">.</span><span style="color:#6F42C1">RefObject</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">HTMLTableElement</span><span style="color:#24292E">&gt;, </span><span style="color:#005CC5">boolean</span><span style="color:#24292E">[][]] {</span></span>
<span class="line"><span style="color:#24292E">  </span><span style="color:#D73A49">const</span><span style="color:#24292E"> </span><span style="color:#005CC5">startIndex</span><span style="color:#24292E"> </span><span style="color:#D73A49">=</span><span style="color:#24292E"> </span><span style="color:#6F42C1">useRef</span><span style="color:#24292E">&lt;</span><span style="color:#005CC5">string</span><span style="color:#24292E">&gt;(</span><span style="color:#032F62">&#x27;&#x27;</span><span style="color:#24292E">);</span></span>
<span class="line"><span style="color:#24292E">  </span><span style="color:#D73A49">const</span><span style="color:#24292E"> </span><span style="color:#005CC5">currentIndex</span><span style="color:#24292E"> </span><span style="color:#D73A49">=</span><span style="color:#24292E"> </span><span style="color:#6F42C1">useRef</span><span style="color:#24292E">&lt;</span><span style="color:#005CC5">string</span><span style="color:#24292E">&gt;(</span><span style="color:#032F62">&#x27;&#x27;</span><span style="color:#24292E">);</span></span>
<span class="line"><span style="color:#24292E">  </span><span style="color:#D73A49">const</span><span style="color:#24292E"> </span><span style="color:#005CC5">startTable</span><span style="color:#24292E"> </span><span style="color:#D73A49">=</span><span style="color:#24292E"> </span><span style="color:#6F42C1">useRef</span><span style="color:#24292E">&lt;</span><span style="color:#005CC5">boolean</span><span style="color:#24292E">[][]&gt;([]);</span></span>
<span class="line"><span style="color:#24292E">  </span><span style="color:#D73A49">const</span><span style="color:#24292E"> </span><span style="color:#005CC5">mode</span><span style="color:#24292E"> </span><span style="color:#D73A49">=</span><span style="color:#24292E"> </span><span style="color:#6F42C1">useRef</span><span style="color:#24292E">&lt;</span><span style="color:#005CC5">boolean</span><span style="color:#24292E">&gt;(</span><span style="color:#005CC5">false</span><span style="color:#24292E">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E">  </span><span style="color:#D73A49">const</span><span style="color:#24292E"> </span><span style="color:#005CC5">tableRef</span><span style="color:#24292E"> </span><span style="color:#D73A49">=</span><span style="color:#24292E"> </span><span style="color:#6F42C1">useRef</span><span style="color:#24292E">&lt;</span><span style="color:#6F42C1">HTMLTableElement</span><span style="color:#24292E">&gt;(</span><span style="color:#005CC5">null</span><span style="color:#24292E">);</span></span>
<span class="line"><span style="color:#24292E">  </span><span style="color:#D73A49">const</span><span style="color:#24292E"> [</span><span style="color:#005CC5">tableValue</span><span style="color:#24292E">, </span><span style="color:#005CC5">setTableValue</span><span style="color:#24292E">] </span><span style="color:#D73A49">=</span><span style="color:#24292E"> </span><span style="color:#6F42C1">useState</span><span style="color:#24292E">&lt;</span><span style="color:#005CC5">boolean</span><span style="color:#24292E">[][]&gt;(initialTable </span><span style="color:#D73A49">??</span><span style="color:#24292E"> []);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E">  </span><span style="color:#6A737D">// ... handler 함수 생략</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E">  </span><span style="color:#6F42C1">useEffect</span><span style="color:#24292E">(() </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#24292E">    </span><span style="color:#D73A49">const</span><span style="color:#24292E"> </span><span style="color:#005CC5">node</span><span style="color:#24292E"> </span><span style="color:#D73A49">=</span><span style="color:#24292E"> tableRef.current?.</span><span style="color:#6F42C1">querySelector</span><span style="color:#24292E">(</span><span style="color:#032F62">&#x27;tbody&#x27;</span><span style="color:#24292E">) </span><span style="color:#D73A49">??</span><span style="color:#24292E"> tableRef.current;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E">    </span><span style="color:#6F42C1">setTableValue</span><span style="color:#24292E">(initialTable </span><span style="color:#D73A49">??</span><span style="color:#24292E"> []);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E">    </span><span style="color:#D73A49">if</span><span style="color:#24292E"> (</span><span style="color:#D73A49">!</span><span style="color:#24292E">initialTable </span><span style="color:#D73A49">&amp;&amp;</span><span style="color:#24292E"> node) {</span></span>
<span class="line"><span style="color:#24292E">      </span><span style="color:#D73A49">const</span><span style="color:#24292E"> </span><span style="color:#005CC5">trs</span><span style="color:#24292E"> </span><span style="color:#D73A49">=</span><span style="color:#24292E"> node.</span><span style="color:#6F42C1">querySelectorAll</span><span style="color:#24292E">(</span><span style="color:#032F62">&#x27;tr&#x27;</span><span style="color:#24292E">);</span></span>
<span class="line"><span style="color:#24292E">      </span><span style="color:#D73A49">const</span><span style="color:#24292E"> </span><span style="color:#005CC5">newTableValues</span><span style="color:#D73A49">:</span><span style="color:#24292E"> </span><span style="color:#005CC5">boolean</span><span style="color:#24292E">[][] </span><span style="color:#D73A49">=</span><span style="color:#24292E"> [];</span></span>
<span class="line"><span style="color:#24292E">      trs.</span><span style="color:#6F42C1">forEach</span><span style="color:#24292E">((</span><span style="color:#E36209">tr</span><span style="color:#24292E">, </span><span style="color:#E36209">i</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#24292E">        </span><span style="color:#D73A49">const</span><span style="color:#24292E"> </span><span style="color:#005CC5">tds</span><span style="color:#24292E"> </span><span style="color:#D73A49">=</span><span style="color:#24292E"> tr.</span><span style="color:#6F42C1">querySelectorAll</span><span style="color:#24292E">(</span><span style="color:#032F62">&#x27;td&#x27;</span><span style="color:#24292E">);</span></span>
<span class="line"><span style="color:#24292E">        </span><span style="color:#D73A49">const</span><span style="color:#24292E"> </span><span style="color:#005CC5">row</span><span style="color:#D73A49">:</span><span style="color:#24292E"> </span><span style="color:#005CC5">boolean</span><span style="color:#24292E">[] </span><span style="color:#D73A49">=</span><span style="color:#24292E"> [];</span></span>
<span class="line"><span style="color:#24292E">        tds.</span><span style="color:#6F42C1">forEach</span><span style="color:#24292E">((</span><span style="color:#E36209">td</span><span style="color:#24292E">, </span><span style="color:#E36209">j</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#24292E">          row.</span><span style="color:#6F42C1">push</span><span style="color:#24292E">(</span><span style="color:#005CC5">false</span><span style="color:#24292E">);</span></span>
<span class="line"><span style="color:#24292E">        });</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E">        </span><span style="color:#D73A49">if</span><span style="color:#24292E"> (tds.</span><span style="color:#005CC5">length</span><span style="color:#24292E"> </span><span style="color:#D73A49">&gt;</span><span style="color:#24292E"> </span><span style="color:#005CC5">0</span><span style="color:#24292E">) {</span></span>
<span class="line"><span style="color:#24292E">          newTableValues.</span><span style="color:#6F42C1">push</span><span style="color:#24292E">(row);</span></span>
<span class="line"><span style="color:#24292E">        }</span></span>
<span class="line"><span style="color:#24292E">      });</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E">      </span><span style="color:#6F42C1">setTableValue</span><span style="color:#24292E">(newTableValues);</span></span>
<span class="line"><span style="color:#24292E">    }</span></span>
<span class="line"><span style="color:#24292E">  }, [initialTable]);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E">  </span><span style="color:#6F42C1">useEffect</span><span style="color:#24292E">(() </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#24292E">    </span><span style="color:#D73A49">const</span><span style="color:#24292E"> </span><span style="color:#005CC5">node</span><span style="color:#24292E"> </span><span style="color:#D73A49">=</span><span style="color:#24292E"> tableRef.current?.</span><span style="color:#6F42C1">querySelector</span><span style="color:#24292E">(</span><span style="color:#032F62">&#x27;tbody&#x27;</span><span style="color:#24292E">) </span><span style="color:#D73A49">??</span><span style="color:#24292E"> tableRef.current;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E">    </span><span style="color:#D73A49">if</span><span style="color:#24292E"> (node) {</span></span>
<span class="line"><span style="color:#24292E">      node.</span><span style="color:#6F42C1">addEventListener</span><span style="color:#24292E">(</span><span style="color:#032F62">&#x27;touchstart&#x27;</span><span style="color:#24292E">, handlePointerStart);</span></span>
<span class="line"><span style="color:#24292E">      node.</span><span style="color:#6F42C1">addEventListener</span><span style="color:#24292E">(</span><span style="color:#032F62">&#x27;mousedown&#x27;</span><span style="color:#24292E">, handlePointerStart);</span></span>
<span class="line"><span style="color:#24292E">      node.</span><span style="color:#6F42C1">addEventListener</span><span style="color:#24292E">(</span><span style="color:#032F62">&#x27;touchmove&#x27;</span><span style="color:#24292E">, handlePointerMove);</span></span>
<span class="line"><span style="color:#24292E">      node.</span><span style="color:#6F42C1">addEventListener</span><span style="color:#24292E">(</span><span style="color:#032F62">&#x27;mouseover&#x27;</span><span style="color:#24292E">, handlePointerMove);</span></span>
<span class="line"><span style="color:#24292E">      node.</span><span style="color:#6F42C1">addEventListener</span><span style="color:#24292E">(</span><span style="color:#032F62">&#x27;touchend&#x27;</span><span style="color:#24292E">, handlePointerEnd);</span></span>
<span class="line"><span style="color:#24292E">      node.</span><span style="color:#6F42C1">addEventListener</span><span style="color:#24292E">(</span><span style="color:#032F62">&#x27;mouseup&#x27;</span><span style="color:#24292E">, handlePointerEnd);</span></span>
<span class="line"><span style="color:#24292E">      </span><span style="color:#D73A49">return</span><span style="color:#24292E"> () </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#24292E">        node.</span><span style="color:#6F42C1">removeEventListener</span><span style="color:#24292E">(</span><span style="color:#032F62">&#x27;touchstart&#x27;</span><span style="color:#24292E">, handlePointerStart);</span></span>
<span class="line"><span style="color:#24292E">        node.</span><span style="color:#6F42C1">removeEventListener</span><span style="color:#24292E">(</span><span style="color:#032F62">&#x27;mousedown&#x27;</span><span style="color:#24292E">, handlePointerStart);</span></span>
<span class="line"><span style="color:#24292E">        node.</span><span style="color:#6F42C1">removeEventListener</span><span style="color:#24292E">(</span><span style="color:#032F62">&#x27;touchmove&#x27;</span><span style="color:#24292E">, handlePointerMove);</span></span>
<span class="line"><span style="color:#24292E">        node.</span><span style="color:#6F42C1">removeEventListener</span><span style="color:#24292E">(</span><span style="color:#032F62">&#x27;mouseover&#x27;</span><span style="color:#24292E">, handlePointerMove);</span></span>
<span class="line"><span style="color:#24292E">        node.</span><span style="color:#6F42C1">removeEventListener</span><span style="color:#24292E">(</span><span style="color:#032F62">&#x27;touchend&#x27;</span><span style="color:#24292E">, handlePointerEnd);</span></span>
<span class="line"><span style="color:#24292E">        node.</span><span style="color:#6F42C1">removeEventListener</span><span style="color:#24292E">(</span><span style="color:#032F62">&#x27;mouseup&#x27;</span><span style="color:#24292E">, handlePointerEnd);</span></span>
<span class="line"><span style="color:#24292E">      };</span></span>
<span class="line"><span style="color:#24292E">    }</span></span>
<span class="line"><span style="color:#24292E">  }, [handlePointerStart, handlePointerMove, handlePointerEnd]);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E">  </span><span style="color:#D73A49">return</span><span style="color:#24292E"> [tableRef, tableValue];</span></span>
<span class="line"><span style="color:#24292E">}</span></span></code></div></pre></div>
<p><code>ref</code>와 <code>value</code>를 리턴하는 훅을 만들었고 기존 테이블에 있던 드래그 로직을 전부 훅으로 옮겼습니다. 추가적으로 <code>initialTable</code>을 옵션으로 받을 수 있도록 해서 만약 <code>initialTable</code>을 받지 않았다면 직접 테이블을 파싱하여 <code>value</code>이차원 배열을 만들도록 하였습니다.</p>
<p>이제 모든 컴포넌트에서 이 훅을 가져와 기존 테이블의 기능을 확장하여 사용할 수 있습니다.</p>
<div data-rehype-pretty-code-fragment=""><pre data-language="tsx" data-theme="dark" class="pre_pre__iJ9A8 group"><div data-language="tsx" class="pre_label__h_sWI">tsx</div><div class="pre_button-wrapper__UqcNw group-hover:opacity-100"><button class="transition-all rounded-md p-2 text-gray-400 hover:bg-gray-100 active:bg-gray-200 text-gray-500 dark:hover:bg-gray-600 dark:active:bg-gray-700"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><div class="pre_code__KcFrc"><code data-language="tsx" data-theme="dark"><span class="line"><span style="color:#F97583">function</span><span style="color:#E1E4E8"> </span><span style="color:#B392F0">MyTable</span><span style="color:#E1E4E8">() {</span></span>
<span class="line"><span style="color:#E1E4E8">  </span><span style="color:#F97583">const</span><span style="color:#E1E4E8"> </span><span style="color:#79B8FF">initialTable</span><span style="color:#E1E4E8"> </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> Array.</span><span style="color:#B392F0">from</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">Array</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">5</span><span style="color:#E1E4E8">), () </span><span style="color:#F97583">=&gt;</span><span style="color:#E1E4E8"> </span><span style="color:#F97583">new</span><span style="color:#E1E4E8"> </span><span style="color:#B392F0">Array</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">5</span><span style="color:#E1E4E8">).</span><span style="color:#B392F0">fill</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">false</span><span style="color:#E1E4E8">));</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">  </span><span style="color:#F97583">const</span><span style="color:#E1E4E8"> [</span><span style="color:#79B8FF">tableRef</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">tableValue</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> </span><span style="color:#B392F0">useTableDragSelect</span><span style="color:#E1E4E8">(initialTable);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">  </span><span style="color:#F97583">return</span><span style="color:#E1E4E8"> (</span></span>
<span class="line"><span style="color:#E1E4E8">    &lt;</span><span style="color:#79B8FF">Table</span><span style="color:#E1E4E8"> </span><span style="color:#B392F0">ref</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">{tableRef}&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">      &lt;</span><span style="color:#79B8FF">THead</span><span style="color:#E1E4E8">&gt;{</span><span style="color:#6A737D">/* ...생략 */</span><span style="color:#E1E4E8">}&lt;/</span><span style="color:#79B8FF">THead</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">      &lt;</span><span style="color:#79B8FF">TBody</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">        {tableValue.</span><span style="color:#B392F0">map</span><span style="color:#E1E4E8">((</span><span style="color:#FFAB70">row</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">rowIndex</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">=&gt;</span><span style="color:#E1E4E8"> (</span></span>
<span class="line"><span style="color:#E1E4E8">          &lt;</span><span style="color:#79B8FF">TR</span><span style="color:#E1E4E8"> </span><span style="color:#B392F0">key</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">{rowIndex}&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">            &lt;</span><span style="color:#79B8FF">TH</span><span style="color:#E1E4E8">&gt;{time}&lt;/</span><span style="color:#79B8FF">TH</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">            {row.</span><span style="color:#B392F0">map</span><span style="color:#E1E4E8">(() </span><span style="color:#F97583">=&gt;</span><span style="color:#E1E4E8"> (</span></span>
<span class="line"><span style="color:#E1E4E8">              &lt;</span><span style="color:#79B8FF">TD</span><span style="color:#E1E4E8">&gt;&lt;/</span><span style="color:#79B8FF">TD</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">            ))}</span></span>
<span class="line"><span style="color:#E1E4E8">          &lt;/</span><span style="color:#79B8FF">TR</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">        ))}</span></span>
<span class="line"><span style="color:#E1E4E8">      &lt;/</span><span style="color:#79B8FF">TBody</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">    &lt;/</span><span style="color:#79B8FF">Table</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">  );</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></div></pre><pre data-language="tsx" data-theme="light" class="pre_pre__iJ9A8 group"><div data-language="tsx" class="pre_label__h_sWI">tsx</div><div class="pre_button-wrapper__UqcNw group-hover:opacity-100"><button class="transition-all rounded-md p-2 text-gray-400 hover:bg-gray-100 active:bg-gray-200 text-gray-500 dark:hover:bg-gray-600 dark:active:bg-gray-700"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><div class="pre_code__KcFrc"><code data-language="tsx" data-theme="light"><span class="line"><span style="color:#D73A49">function</span><span style="color:#24292E"> </span><span style="color:#6F42C1">MyTable</span><span style="color:#24292E">() {</span></span>
<span class="line"><span style="color:#24292E">  </span><span style="color:#D73A49">const</span><span style="color:#24292E"> </span><span style="color:#005CC5">initialTable</span><span style="color:#24292E"> </span><span style="color:#D73A49">=</span><span style="color:#24292E"> Array.</span><span style="color:#6F42C1">from</span><span style="color:#24292E">(</span><span style="color:#6F42C1">Array</span><span style="color:#24292E">(</span><span style="color:#005CC5">5</span><span style="color:#24292E">), () </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> </span><span style="color:#D73A49">new</span><span style="color:#24292E"> </span><span style="color:#6F42C1">Array</span><span style="color:#24292E">(</span><span style="color:#005CC5">5</span><span style="color:#24292E">).</span><span style="color:#6F42C1">fill</span><span style="color:#24292E">(</span><span style="color:#005CC5">false</span><span style="color:#24292E">));</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E">  </span><span style="color:#D73A49">const</span><span style="color:#24292E"> [</span><span style="color:#005CC5">tableRef</span><span style="color:#24292E">, </span><span style="color:#005CC5">tableValue</span><span style="color:#24292E">] </span><span style="color:#D73A49">=</span><span style="color:#24292E"> </span><span style="color:#6F42C1">useTableDragSelect</span><span style="color:#24292E">(initialTable);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E">  </span><span style="color:#D73A49">return</span><span style="color:#24292E"> (</span></span>
<span class="line"><span style="color:#24292E">    &lt;</span><span style="color:#005CC5">Table</span><span style="color:#24292E"> </span><span style="color:#6F42C1">ref</span><span style="color:#D73A49">=</span><span style="color:#24292E">{tableRef}&gt;</span></span>
<span class="line"><span style="color:#24292E">      &lt;</span><span style="color:#005CC5">THead</span><span style="color:#24292E">&gt;{</span><span style="color:#6A737D">/* ...생략 */</span><span style="color:#24292E">}&lt;/</span><span style="color:#005CC5">THead</span><span style="color:#24292E">&gt;</span></span>
<span class="line"><span style="color:#24292E">      &lt;</span><span style="color:#005CC5">TBody</span><span style="color:#24292E">&gt;</span></span>
<span class="line"><span style="color:#24292E">        {tableValue.</span><span style="color:#6F42C1">map</span><span style="color:#24292E">((</span><span style="color:#E36209">row</span><span style="color:#24292E">, </span><span style="color:#E36209">rowIndex</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> (</span></span>
<span class="line"><span style="color:#24292E">          &lt;</span><span style="color:#005CC5">TR</span><span style="color:#24292E"> </span><span style="color:#6F42C1">key</span><span style="color:#D73A49">=</span><span style="color:#24292E">{rowIndex}&gt;</span></span>
<span class="line"><span style="color:#24292E">            &lt;</span><span style="color:#005CC5">TH</span><span style="color:#24292E">&gt;{time}&lt;/</span><span style="color:#005CC5">TH</span><span style="color:#24292E">&gt;</span></span>
<span class="line"><span style="color:#24292E">            {row.</span><span style="color:#6F42C1">map</span><span style="color:#24292E">(() </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> (</span></span>
<span class="line"><span style="color:#24292E">              &lt;</span><span style="color:#005CC5">TD</span><span style="color:#24292E">&gt;&lt;/</span><span style="color:#005CC5">TD</span><span style="color:#24292E">&gt;</span></span>
<span class="line"><span style="color:#24292E">            ))}</span></span>
<span class="line"><span style="color:#24292E">          &lt;/</span><span style="color:#005CC5">TR</span><span style="color:#24292E">&gt;</span></span>
<span class="line"><span style="color:#24292E">        ))}</span></span>
<span class="line"><span style="color:#24292E">      &lt;/</span><span style="color:#005CC5">TBody</span><span style="color:#24292E">&gt;</span></span>
<span class="line"><span style="color:#24292E">    &lt;/</span><span style="color:#005CC5">Table</span><span style="color:#24292E">&gt;</span></span>
<span class="line"><span style="color:#24292E">  );</span></span>
<span class="line"><span style="color:#24292E">}</span></span></code></div></pre></div>
<p><code>initialTable</code>이 없다면 아래처럼 테이블이 완성되어 있어야 합니다.</p>
<div data-rehype-pretty-code-fragment=""><pre data-language="tsx" data-theme="dark" class="pre_pre__iJ9A8 group"><div data-language="tsx" class="pre_label__h_sWI">tsx</div><div class="pre_button-wrapper__UqcNw group-hover:opacity-100"><button class="transition-all rounded-md p-2 text-gray-400 hover:bg-gray-100 active:bg-gray-200 text-gray-500 dark:hover:bg-gray-600 dark:active:bg-gray-700"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><div class="pre_code__KcFrc"><code data-language="tsx" data-theme="dark"><span class="line"><span style="color:#F97583">function</span><span style="color:#E1E4E8"> </span><span style="color:#B392F0">MyTable</span><span style="color:#E1E4E8">() {</span></span>
<span class="line"><span style="color:#E1E4E8">  </span><span style="color:#F97583">const</span><span style="color:#E1E4E8"> [</span><span style="color:#79B8FF">tableRef</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">tableValue</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> </span><span style="color:#B392F0">useTableDragSelect</span><span style="color:#E1E4E8">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">  console.</span><span style="color:#B392F0">log</span><span style="color:#E1E4E8">(tableValeu); </span><span style="color:#6A737D">// 3*5 size Array</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">  </span><span style="color:#F97583">return</span><span style="color:#E1E4E8"> (</span></span>
<span class="line"><span style="color:#E1E4E8">    &lt;</span><span style="color:#79B8FF">Table</span><span style="color:#E1E4E8"> </span><span style="color:#B392F0">ref</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">{tableRef}&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">      &lt;</span><span style="color:#79B8FF">THead</span><span style="color:#E1E4E8">&gt;{</span><span style="color:#6A737D">/* ...생략 */</span><span style="color:#E1E4E8">}&lt;/</span><span style="color:#79B8FF">THead</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">      &lt;</span><span style="color:#79B8FF">TBody</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">        &lt;</span><span style="color:#79B8FF">TR</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">          &lt;</span><span style="color:#79B8FF">TH</span><span style="color:#E1E4E8">&gt;&lt;/</span><span style="color:#79B8FF">TH</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">          &lt;</span><span style="color:#79B8FF">TD</span><span style="color:#E1E4E8">&gt;&lt;/</span><span style="color:#79B8FF">TD</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">          &lt;</span><span style="color:#79B8FF">TD</span><span style="color:#E1E4E8">&gt;&lt;/</span><span style="color:#79B8FF">TD</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">          &lt;</span><span style="color:#79B8FF">TD</span><span style="color:#E1E4E8">&gt;&lt;/</span><span style="color:#79B8FF">TD</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">          &lt;</span><span style="color:#79B8FF">TD</span><span style="color:#E1E4E8">&gt;&lt;/</span><span style="color:#79B8FF">TD</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">          &lt;</span><span style="color:#79B8FF">TD</span><span style="color:#E1E4E8">&gt;&lt;/</span><span style="color:#79B8FF">TD</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">        &lt;/</span><span style="color:#79B8FF">TR</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">        &lt;</span><span style="color:#79B8FF">TR</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">          &lt;</span><span style="color:#79B8FF">TH</span><span style="color:#E1E4E8">&gt;&lt;/</span><span style="color:#79B8FF">TH</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">          &lt;</span><span style="color:#79B8FF">TD</span><span style="color:#E1E4E8">&gt;&lt;/</span><span style="color:#79B8FF">TD</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">          &lt;</span><span style="color:#79B8FF">TD</span><span style="color:#E1E4E8">&gt;&lt;/</span><span style="color:#79B8FF">TD</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">          &lt;</span><span style="color:#79B8FF">TD</span><span style="color:#E1E4E8">&gt;&lt;/</span><span style="color:#79B8FF">TD</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">          &lt;</span><span style="color:#79B8FF">TD</span><span style="color:#E1E4E8">&gt;&lt;/</span><span style="color:#79B8FF">TD</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">          &lt;</span><span style="color:#79B8FF">TD</span><span style="color:#E1E4E8">&gt;&lt;/</span><span style="color:#79B8FF">TD</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">        &lt;/</span><span style="color:#79B8FF">TR</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">        &lt;</span><span style="color:#79B8FF">TR</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">          &lt;</span><span style="color:#79B8FF">TH</span><span style="color:#E1E4E8">&gt;&lt;/</span><span style="color:#79B8FF">TH</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">          &lt;</span><span style="color:#79B8FF">TD</span><span style="color:#E1E4E8">&gt;&lt;/</span><span style="color:#79B8FF">TD</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">          &lt;</span><span style="color:#79B8FF">TD</span><span style="color:#E1E4E8">&gt;&lt;/</span><span style="color:#79B8FF">TD</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">          &lt;</span><span style="color:#79B8FF">TD</span><span style="color:#E1E4E8">&gt;&lt;/</span><span style="color:#79B8FF">TD</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">          &lt;</span><span style="color:#79B8FF">TD</span><span style="color:#E1E4E8">&gt;&lt;/</span><span style="color:#79B8FF">TD</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">          &lt;</span><span style="color:#79B8FF">TD</span><span style="color:#E1E4E8">&gt;&lt;/</span><span style="color:#79B8FF">TD</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">        &lt;/</span><span style="color:#79B8FF">TR</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">      &lt;/</span><span style="color:#79B8FF">TBody</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">    &lt;/</span><span style="color:#79B8FF">Table</span><span style="color:#E1E4E8">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8">  );</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></div></pre><pre data-language="tsx" data-theme="light" class="pre_pre__iJ9A8 group"><div data-language="tsx" class="pre_label__h_sWI">tsx</div><div class="pre_button-wrapper__UqcNw group-hover:opacity-100"><button class="transition-all rounded-md p-2 text-gray-400 hover:bg-gray-100 active:bg-gray-200 text-gray-500 dark:hover:bg-gray-600 dark:active:bg-gray-700"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><div class="pre_code__KcFrc"><code data-language="tsx" data-theme="light"><span class="line"><span style="color:#D73A49">function</span><span style="color:#24292E"> </span><span style="color:#6F42C1">MyTable</span><span style="color:#24292E">() {</span></span>
<span class="line"><span style="color:#24292E">  </span><span style="color:#D73A49">const</span><span style="color:#24292E"> [</span><span style="color:#005CC5">tableRef</span><span style="color:#24292E">, </span><span style="color:#005CC5">tableValue</span><span style="color:#24292E">] </span><span style="color:#D73A49">=</span><span style="color:#24292E"> </span><span style="color:#6F42C1">useTableDragSelect</span><span style="color:#24292E">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E">  console.</span><span style="color:#6F42C1">log</span><span style="color:#24292E">(tableValeu); </span><span style="color:#6A737D">// 3*5 size Array</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E">  </span><span style="color:#D73A49">return</span><span style="color:#24292E"> (</span></span>
<span class="line"><span style="color:#24292E">    &lt;</span><span style="color:#005CC5">Table</span><span style="color:#24292E"> </span><span style="color:#6F42C1">ref</span><span style="color:#D73A49">=</span><span style="color:#24292E">{tableRef}&gt;</span></span>
<span class="line"><span style="color:#24292E">      &lt;</span><span style="color:#005CC5">THead</span><span style="color:#24292E">&gt;{</span><span style="color:#6A737D">/* ...생략 */</span><span style="color:#24292E">}&lt;/</span><span style="color:#005CC5">THead</span><span style="color:#24292E">&gt;</span></span>
<span class="line"><span style="color:#24292E">      &lt;</span><span style="color:#005CC5">TBody</span><span style="color:#24292E">&gt;</span></span>
<span class="line"><span style="color:#24292E">        &lt;</span><span style="color:#005CC5">TR</span><span style="color:#24292E">&gt;</span></span>
<span class="line"><span style="color:#24292E">          &lt;</span><span style="color:#005CC5">TH</span><span style="color:#24292E">&gt;&lt;/</span><span style="color:#005CC5">TH</span><span style="color:#24292E">&gt;</span></span>
<span class="line"><span style="color:#24292E">          &lt;</span><span style="color:#005CC5">TD</span><span style="color:#24292E">&gt;&lt;/</span><span style="color:#005CC5">TD</span><span style="color:#24292E">&gt;</span></span>
<span class="line"><span style="color:#24292E">          &lt;</span><span style="color:#005CC5">TD</span><span style="color:#24292E">&gt;&lt;/</span><span style="color:#005CC5">TD</span><span style="color:#24292E">&gt;</span></span>
<span class="line"><span style="color:#24292E">          &lt;</span><span style="color:#005CC5">TD</span><span style="color:#24292E">&gt;&lt;/</span><span style="color:#005CC5">TD</span><span style="color:#24292E">&gt;</span></span>
<span class="line"><span style="color:#24292E">          &lt;</span><span style="color:#005CC5">TD</span><span style="color:#24292E">&gt;&lt;/</span><span style="color:#005CC5">TD</span><span style="color:#24292E">&gt;</span></span>
<span class="line"><span style="color:#24292E">          &lt;</span><span style="color:#005CC5">TD</span><span style="color:#24292E">&gt;&lt;/</span><span style="color:#005CC5">TD</span><span style="color:#24292E">&gt;</span></span>
<span class="line"><span style="color:#24292E">        &lt;/</span><span style="color:#005CC5">TR</span><span style="color:#24292E">&gt;</span></span>
<span class="line"><span style="color:#24292E">        &lt;</span><span style="color:#005CC5">TR</span><span style="color:#24292E">&gt;</span></span>
<span class="line"><span style="color:#24292E">          &lt;</span><span style="color:#005CC5">TH</span><span style="color:#24292E">&gt;&lt;/</span><span style="color:#005CC5">TH</span><span style="color:#24292E">&gt;</span></span>
<span class="line"><span style="color:#24292E">          &lt;</span><span style="color:#005CC5">TD</span><span style="color:#24292E">&gt;&lt;/</span><span style="color:#005CC5">TD</span><span style="color:#24292E">&gt;</span></span>
<span class="line"><span style="color:#24292E">          &lt;</span><span style="color:#005CC5">TD</span><span style="color:#24292E">&gt;&lt;/</span><span style="color:#005CC5">TD</span><span style="color:#24292E">&gt;</span></span>
<span class="line"><span style="color:#24292E">          &lt;</span><span style="color:#005CC5">TD</span><span style="color:#24292E">&gt;&lt;/</span><span style="color:#005CC5">TD</span><span style="color:#24292E">&gt;</span></span>
<span class="line"><span style="color:#24292E">          &lt;</span><span style="color:#005CC5">TD</span><span style="color:#24292E">&gt;&lt;/</span><span style="color:#005CC5">TD</span><span style="color:#24292E">&gt;</span></span>
<span class="line"><span style="color:#24292E">          &lt;</span><span style="color:#005CC5">TD</span><span style="color:#24292E">&gt;&lt;/</span><span style="color:#005CC5">TD</span><span style="color:#24292E">&gt;</span></span>
<span class="line"><span style="color:#24292E">        &lt;/</span><span style="color:#005CC5">TR</span><span style="color:#24292E">&gt;</span></span>
<span class="line"><span style="color:#24292E">        &lt;</span><span style="color:#005CC5">TR</span><span style="color:#24292E">&gt;</span></span>
<span class="line"><span style="color:#24292E">          &lt;</span><span style="color:#005CC5">TH</span><span style="color:#24292E">&gt;&lt;/</span><span style="color:#005CC5">TH</span><span style="color:#24292E">&gt;</span></span>
<span class="line"><span style="color:#24292E">          &lt;</span><span style="color:#005CC5">TD</span><span style="color:#24292E">&gt;&lt;/</span><span style="color:#005CC5">TD</span><span style="color:#24292E">&gt;</span></span>
<span class="line"><span style="color:#24292E">          &lt;</span><span style="color:#005CC5">TD</span><span style="color:#24292E">&gt;&lt;/</span><span style="color:#005CC5">TD</span><span style="color:#24292E">&gt;</span></span>
<span class="line"><span style="color:#24292E">          &lt;</span><span style="color:#005CC5">TD</span><span style="color:#24292E">&gt;&lt;/</span><span style="color:#005CC5">TD</span><span style="color:#24292E">&gt;</span></span>
<span class="line"><span style="color:#24292E">          &lt;</span><span style="color:#005CC5">TD</span><span style="color:#24292E">&gt;&lt;/</span><span style="color:#005CC5">TD</span><span style="color:#24292E">&gt;</span></span>
<span class="line"><span style="color:#24292E">          &lt;</span><span style="color:#005CC5">TD</span><span style="color:#24292E">&gt;&lt;/</span><span style="color:#005CC5">TD</span><span style="color:#24292E">&gt;</span></span>
<span class="line"><span style="color:#24292E">        &lt;/</span><span style="color:#005CC5">TR</span><span style="color:#24292E">&gt;</span></span>
<span class="line"><span style="color:#24292E">      &lt;/</span><span style="color:#005CC5">TBody</span><span style="color:#24292E">&gt;</span></span>
<span class="line"><span style="color:#24292E">    &lt;/</span><span style="color:#005CC5">Table</span><span style="color:#24292E">&gt;</span></span>
<span class="line"><span style="color:#24292E">  );</span></span>
<span class="line"><span style="color:#24292E">}</span></span></code></div></pre></div>
<br/>
<hr/>
<h2 id="결론"><a aria-hidden="true" tabindex="-1" href="#결론"><span class="icon icon-link"></span></a>결론</h2>
<p>위에서 만든 <code>useTableDragSelect</code>이라는 훅을 배포했고 아래의 링크에서 확인해볼 수 있습니다.</p>
<p><a href="https://github.com/jeonbyeongmin/use-table-drag-select">Github: jeonbyeongmin/use-table-drag-select</a></p>
<br/>
<hr/>
<h2 id="참고"><a aria-hidden="true" tabindex="-1" href="#참고"><span class="icon icon-link"></span></a>참고</h2>
<p><a href="https://ui.toast.com/posts/ko_20220106">터치와 클릭, 우리 깐부잖아 - TOAST UI</a>
<a href="https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent">MouseEvent - MDN</a>
<a href="https://developer.mozilla.org/en-US/docs/Web/API/TouchEvent">TouchEvent - MDN</a>
<a href="https://ko.javascript.info/pointer-events">Pointer events - javascript.info</a></p></article></main><nav class="w-60 shrink-0 order-last hidden lg:block pl-6 pt-16"><div class="sticky top-10"><h2 class="text-sm font-bold text-gray-600 dark:text-gray-400 mb-3">Test Post</h2><li class="flex flex-col gap-2"><a href="#서론" class="text-sm font-medium transition-all duration-100 text-gray-400 hover:text-gray-600 dark:text-gray-600 dark:hover:text-gray-400 ml-2">서론</a><a href="#구현-기능에-대한-이해" class="text-sm font-medium transition-all duration-100 text-gray-400 hover:text-gray-600 dark:text-gray-600 dark:hover:text-gray-400 ml-2">구현 기능에 대한 이해</a><a href="#요구-사항-작성하기" class="text-sm font-medium transition-all duration-100 text-gray-400 hover:text-gray-600 dark:text-gray-600 dark:hover:text-gray-400 ml-4">요구 사항 작성하기</a><a href="#mouseevent-알아보기" class="text-sm font-medium transition-all duration-100 text-gray-400 hover:text-gray-600 dark:text-gray-600 dark:hover:text-gray-400 ml-4">MouseEvent 알아보기</a><a href="#touchevent-알아보기" class="text-sm font-medium transition-all duration-100 text-gray-400 hover:text-gray-600 dark:text-gray-600 dark:hover:text-gray-400 ml-4">TouchEvent 알아보기</a><a href="#정리하기" class="text-sm font-medium transition-all duration-100 text-gray-400 hover:text-gray-600 dark:text-gray-600 dark:hover:text-gray-400 ml-4">정리하기</a><a href="#구현" class="text-sm font-medium transition-all duration-100 text-gray-400 hover:text-gray-600 dark:text-gray-600 dark:hover:text-gray-400 ml-2">구현</a><a href="#드래그-테이블-컴포넌트-구현하기" class="text-sm font-medium transition-all duration-100 text-gray-400 hover:text-gray-600 dark:text-gray-600 dark:hover:text-gray-400 ml-4">드래그 테이블 컴포넌트 구현하기</a><a href="#핸들러-함수-구현하기" class="text-sm font-medium transition-all duration-100 text-gray-400 hover:text-gray-600 dark:text-gray-600 dark:hover:text-gray-400 ml-4">핸들러 함수 구현하기</a><a href="#구현-팁" class="text-sm font-medium transition-all duration-100 text-gray-400 hover:text-gray-600 dark:text-gray-600 dark:hover:text-gray-400 ml-4">구현 팁</a><a href="#리팩토링" class="text-sm font-medium transition-all duration-100 text-gray-400 hover:text-gray-600 dark:text-gray-600 dark:hover:text-gray-400 ml-2">리팩토링</a><a href="#문제-인식하기" class="text-sm font-medium transition-all duration-100 text-gray-400 hover:text-gray-600 dark:text-gray-600 dark:hover:text-gray-400 ml-4">문제 인식하기</a><a href="#hook-만들기" class="text-sm font-medium transition-all duration-100 text-gray-400 hover:text-gray-600 dark:text-gray-600 dark:hover:text-gray-400 ml-4">Hook 만들기</a><a href="#결론" class="text-sm font-medium transition-all duration-100 text-gray-400 hover:text-gray-600 dark:text-gray-600 dark:hover:text-gray-400 ml-2">결론</a><a href="#참고" class="text-sm font-medium transition-all duration-100 text-gray-400 hover:text-gray-600 dark:text-gray-600 dark:hover:text-gray-400 ml-2">참고</a></li><hr class="w-full my-2 md:my-4 border-gray-200 dark:border-gray-700"/><div><a href="#" class="text-sm font-medium flex gap-2 items-center text-gray-400 hover:text-gray-600 dark:text-gray-600 dark:hover:text-gray-400"><svg stroke="currentColor" fill="none" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M14.8543 11.9741L16.2686 10.5599L12.0259 6.31724L7.78327 10.5599L9.19749 11.9741L11.0259 10.1457V17.6828H13.0259V10.1457L14.8543 11.9741Z" fill="currentColor"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M1 19C1 21.2091 2.79086 23 5 23H19C21.2091 23 23 21.2091 23 19V5C23 2.79086 21.2091 1 19 1H5C2.79086 1 1 2.79086 1 5V19ZM5 21H19C20.1046 21 21 20.1046 21 19V5C21 3.89543 20.1046 3 19 3H5C3.89543 3 3 3.89543 3 5V19C3 20.1046 3.89543 21 5 21Z" fill="currentColor"></path></svg><span class="text-sm">Scroll to top</span></a></div></div></nav></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"params":{"categorySlug":"Test Category","postSlug":"test"},"profile":{"login":"jeonbyeongmin","id":28756358,"node_id":"MDQ6VXNlcjI4NzU2MzU4","avatar_url":"https://avatars.githubusercontent.com/u/28756358?v=4","gravatar_id":"","url":"https://api.github.com/users/jeonbyeongmin","html_url":"https://github.com/jeonbyeongmin","followers_url":"https://api.github.com/users/jeonbyeongmin/followers","following_url":"https://api.github.com/users/jeonbyeongmin/following{/other_user}","gists_url":"https://api.github.com/users/jeonbyeongmin/gists{/gist_id}","starred_url":"https://api.github.com/users/jeonbyeongmin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jeonbyeongmin/subscriptions","organizations_url":"https://api.github.com/users/jeonbyeongmin/orgs","repos_url":"https://api.github.com/users/jeonbyeongmin/repos","events_url":"https://api.github.com/users/jeonbyeongmin/events{/privacy}","received_events_url":"https://api.github.com/users/jeonbyeongmin/received_events","type":"User","site_admin":false,"name":"Byeongmin Jeon","company":null,"blog":"https://velog.io/@jeonbyeongmin","location":null,"email":null,"hireable":null,"bio":"JavaScript/React developer","twitter_username":null,"public_repos":43,"public_gists":1,"followers":25,"following":22,"created_at":"2017-05-17T12:21:04Z","updated_at":"2023-06-03T11:24:38Z"}},"__N_SSG":true},"page":"/[categorySlug]/[postSlug]","query":{"categorySlug":"Test Category","postSlug":"test"},"buildId":"w4U2GQiaVQ1l-eevK1JWn","assetPrefix":"/wiki","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>